import{z as vt,d as et,l as wt,a as $t,c as O,b as $,v as bt,t as H,B as gt,i as p,m as _,j as d,R as yt,g as I,S as Q,D as kt,G as Dt,F as Tt,x as St,u as K,e as F,o as Ct,A as Et}from"./calendar-K225rnsu.js";var Mt=H("<div style=position:absolute;border-radius:3px>"),Rt=H("<div style=position:absolute;border-radius:3px;color:#fff;font-size:11px;padding-left:4px;overflow:hidden>"),X=H("<div style=position:absolute;border-radius:3px;color:#fff;font-size:11px;padding-left:4px;overflow:hidden><div style=position:absolute;left:0;top:0;width:6px;height:100%;cursor:ew-resize></div><div style=position:absolute;right:0;top:0;width:6px;height:100%;cursor:ew-resize>"),_t=H("<div style=position:absolute;border-radius:3px;color:#fff;font-size:11px;padding-left:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box><div style=position:absolute;left:0;top:0;width:6px;height:100%;cursor:ew-resize></div><div style=position:absolute;right:0;top:0;width:6px;height:100%;cursor:ew-resize>"),It=H("<div style=position:absolute;border-radius:3px;color:#fff;font-size:11px;padding-left:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box>"),Bt=H('<div style="width:120px;flex-shrink:0;background:#222;border-right:1px solid #444;overflow:hidden"><div></div><div>'),Ht=H("<div style=position:sticky;top:0;z-index:10>"),Lt=H("<svg style=position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none>"),zt=H('<div style=height:100%;display:flex;flex-direction:column><div style="padding:8px 16px;background:#2a2a2a;display:flex;gap:16px;align-items:center;flex-wrap:wrap"><span style=font-weight:bold>PerfIsolate</span><span>Bar: </span><span>Features: </span><span>Visible: </span><span style=color:#888;font-size:11px>?bar=minimal|text|handles|reactive|drag|events|full &amp; grid=1 &amp; headers=1 &amp; resources=1</span></div><div style=flex:1;display:flex;overflow:hidden><div style=flex:1;overflow:auto;position:relative><div style=position:relative>');const T=24,W=4,ot=6,z=24*ot,ht=2,ut=200,rt=vt.tasks.map(l=>({...l,_start:et.parse(l.start),_end:et.parse(l.end)})),nt=new Date(Math.min(...rt.map(l=>l._start.getTime()))),it=[...new Set(vt.tasks.map(l=>l.resource))].sort(),Wt=Object.fromEntries(it.map((l,r)=>[l,r])),Y=it.length,At=Math.max(...rt.map(l=>l._end.getTime())),N=Math.ceil((At-nt.getTime())/(1e3*60*60*24))+1,U=N*z,tt=Y*(T+W),Z=(()=>{const l={},r=nt.getTime();return rt.forEach((a,o)=>{const c=Wt[a.resource]??0,s=(a._start.getTime()-r)/(1e3*60*60),g=(a._end.getTime()-r)/(1e3*60*60),n=s*ot,t=(g-s)*ot;l[a.id]={...a,locked:o%7===0,progress:a.progress||0,$bar:{x:n,y:c*(T+W),width:Math.max(t,6),height:T}}}),l})();(()=>{const l={};for(let r=0;r<Y;r++)l[r]=[];return Object.entries(Z).forEach(([r,a])=>{const o=Math.floor(a.$bar.y/(T+W));l[o].push(r)}),l})();const q=z,Pt=(()=>{const l={};return Object.entries(Z).forEach(([r,a])=>{const o=Math.floor(a.$bar.y/(T+W)),c=a.$bar,s=Math.floor(c.x/q),g=Math.floor((c.x+c.width)/q);l[o]||(l[o]={});for(let n=s;n<=g;n++)(l[o][n]=l[o][n]||[]).push(r)}),l})();console.log(`PerfIsolate: ${Object.keys(Z).length} tasks, ${Y} rows, ${N} days`);function xt(l){const r=l.task,a=r.$bar;return(()=>{var o=Mt();return I(c=>{var s=`translate(${a.x}px, ${a.y}px)`,g=`${a.width}px`,n=`${a.height}px`,t=r.color;return s!==c.e&&d(o,"transform",c.e=s),g!==c.t&&d(o,"width",c.t=g),n!==c.a&&d(o,"height",c.a=n),t!==c.o&&d(o,"background",c.o=t),c},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}function Ot(l){const r=l.task,a=r.$bar;return(()=>{var o=Rt();return p(o,()=>r.name),I(c=>{var s=`translate(${a.x}px, ${a.y}px)`,g=`${a.width}px`,n=`${a.height}px`,t=r.color,e=`${a.height}px`;return s!==c.e&&d(o,"transform",c.e=s),g!==c.t&&d(o,"width",c.t=g),n!==c.a&&d(o,"height",c.a=n),t!==c.o&&d(o,"background",c.o=t),e!==c.i&&d(o,"line-height",c.i=e),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o})()}function Yt(l){const r=l.task,a=r.$bar;return(()=>{var o=X(),c=o.firstChild;return c.nextSibling,p(o,()=>r.name,c),I(s=>{var g=`translate(${a.x}px, ${a.y}px)`,n=`${a.width}px`,t=`${a.height}px`,e=r.color,i=`${a.height}px`;return g!==s.e&&d(o,"transform",s.e=g),n!==s.t&&d(o,"width",s.t=n),t!==s.a&&d(o,"height",s.a=t),e!==s.o&&d(o,"background",s.o=e),i!==s.i&&d(o,"line-height",s.i=i),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o})()}function Ft(l){const r=()=>l.task,a=()=>r().$bar;return(()=>{var o=X(),c=o.firstChild;return c.nextSibling,p(o,()=>r().name,c),I(s=>{var g=`translate(${a().x}px, ${a().y}px)`,n=`${a().width}px`,t=`${a().height}px`,e=r().color,i=`${a().height}px`;return g!==s.e&&d(o,"transform",s.e=g),n!==s.t&&d(o,"width",s.t=n),t!==s.a&&d(o,"height",s.a=t),e!==s.o&&d(o,"background",s.o=e),i!==s.i&&d(o,"line-height",s.i=i),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o})()}function Xt(l){const r=()=>l.task,a=()=>r().$bar,{isDragging:o,startDrag:c}=F({onDragStart:()=>{},onDragMove:()=>{},onDragEnd:()=>{}});return(()=>{var s=X(),g=s.firstChild,n=g.nextSibling;return s.$$mousedown=t=>c(t,"dragging_bar",{taskId:r().id}),p(s,()=>r().name,g),g.$$mousedown=t=>{t.stopPropagation(),c(t,"dragging_left",{taskId:r().id})},n.$$mousedown=t=>{t.stopPropagation(),c(t,"dragging_right",{taskId:r().id})},I(t=>{var e=`translate(${a().x}px, ${a().y}px)`,i=`${a().width}px`,v=`${a().height}px`,h=o()?"grabbing":"grab",x=r().color,w=`${a().height}px`;return e!==t.e&&d(s,"transform",t.e=e),i!==t.t&&d(s,"width",t.t=i),v!==t.a&&d(s,"height",t.a=v),h!==t.o&&d(s,"cursor",t.o=h),x!==t.i&&d(s,"background",t.i=x),w!==t.n&&d(s,"line-height",t.n=w),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),s})()}function Gt(l){const r=K(),a=()=>l.task,o=()=>a().$bar,{isDragging:c,startDrag:s}=F({onDragStart:()=>{},onDragMove:()=>{},onDragEnd:()=>{}});return(()=>{var g=X(),n=g.firstChild,t=n.nextSibling;return g.$$mousedown=e=>s(e,"dragging_bar",{taskId:a().id}),g.$$click=e=>{var i;return(i=r.onTaskClick)==null?void 0:i.call(r,a().id,e)},g.addEventListener("mouseleave",()=>{var e;return(e=r.onHoverEnd)==null?void 0:e.call(r)}),g.addEventListener("mouseenter",e=>{var i;return(i=r.onHover)==null?void 0:i.call(r,a().id,e.clientX,e.clientY)}),p(g,()=>a().name,n),n.$$mousedown=e=>{e.stopPropagation(),s(e,"dragging_left",{taskId:a().id})},t.$$mousedown=e=>{e.stopPropagation(),s(e,"dragging_right",{taskId:a().id})},I(e=>{var i=`translate(${o().x}px, ${o().y}px)`,v=`${o().width}px`,h=`${o().height}px`,x=c()?"grabbing":"grab",w=a().color,b=`${o().height}px`;return i!==e.e&&d(g,"transform",e.e=i),v!==e.t&&d(g,"width",e.t=v),h!==e.a&&d(g,"height",e.a=h),x!==e.o&&d(g,"cursor",e.o=x),w!==e.i&&d(g,"background",e.i=w),b!==e.n&&d(g,"line-height",e.n=b),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),g})()}function Vt(l){const r=K(),a=()=>l.task,o=()=>a().$bar,c=()=>a().progress??0,s=()=>o().width*c()/100,g=()=>{const e=a().color||"#3b82f6",i=s();return`linear-gradient(to right, ${e}80 0px, ${e}80 ${i}px, ${e}40 ${i}px, ${e}40 100%)`},{isDragging:n,startDrag:t}=F({onDragStart:()=>{},onDragMove:()=>{},onDragEnd:()=>{}});return(()=>{var e=X(),i=e.firstChild,v=i.nextSibling;return e.$$mousedown=h=>t(h,"dragging_bar",{taskId:a().id}),e.$$click=h=>{var x;return(x=r.onTaskClick)==null?void 0:x.call(r,a().id,h)},e.addEventListener("mouseleave",()=>{var h;return(h=r.onHoverEnd)==null?void 0:h.call(r)}),e.addEventListener("mouseenter",h=>{var x;return(x=r.onHover)==null?void 0:x.call(r,a().id,h.clientX,h.clientY)}),p(e,()=>a().name,i),i.$$mousedown=h=>{h.stopPropagation(),t(h,"dragging_left",{taskId:a().id})},v.$$mousedown=h=>{h.stopPropagation(),t(h,"dragging_right",{taskId:a().id})},I(h=>{var x=`translate(${o().x}px, ${o().y}px)`,w=`${o().width}px`,b=`${o().height}px`,L=n()?"grabbing":"grab",G=g(),A=`${o().height}px`;return x!==h.e&&d(e,"transform",h.e=x),w!==h.t&&d(e,"width",h.t=w),b!==h.a&&d(e,"height",h.a=b),L!==h.o&&d(e,"cursor",h.o=L),G!==h.i&&d(e,"background",h.i=G),A!==h.n&&d(e,"line-height",h.n=A),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),e})()}function jt(l){const r=K(),a=()=>typeof l.task=="function"?l.task():l.task,o=$(()=>{const n=a(),t=n==null?void 0:n.$bar,e=(n==null?void 0:n.progress)??0,i=(t==null?void 0:t.width)??40;return{colorBg:(n==null?void 0:n.color_bg)??"rgba(59,130,246,0.15)",colorFill:(n==null?void 0:n.color_fill)??"rgba(59,130,246,0.3)",locked:(n==null?void 0:n.locked)??!1,name:(n==null?void 0:n.name)??"",id:(n==null?void 0:n.id)??"",x:(t==null?void 0:t.x)??0,y:(t==null?void 0:t.y)??0,width:i,height:(t==null?void 0:t.height)??T,pw:i*e/100}}),c=()=>{const n=o(),t=n.pw;return`linear-gradient(to right, ${n.colorFill} 0px, ${n.colorFill} ${t}px, ${n.colorBg} ${t}px, ${n.colorBg} 100%)${n.locked?", repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(0,0,0,0.15) 3px, rgba(0,0,0,0.15) 6px)":""}`},{isDragging:s,startDrag:g}=F({onDragStart:()=>{},onDragMove:()=>{},onDragEnd:()=>{}});return(()=>{var n=_t(),t=n.firstChild,e=t.nextSibling;return n.$$mousedown=i=>g(i,"dragging_bar",{taskId:o().id}),n.$$click=i=>{var v;return(v=r.onTaskClick)==null?void 0:v.call(r,o().id,i)},n.addEventListener("mouseleave",()=>{var i;return(i=r.onHoverEnd)==null?void 0:i.call(r)}),n.addEventListener("mouseenter",i=>{var v;return(v=r.onHover)==null?void 0:v.call(r,o().id,i.clientX,i.clientY)}),p(n,()=>o().name,t),t.$$mousedown=i=>{i.stopPropagation(),g(i,"dragging_left",{taskId:o().id})},e.$$mousedown=i=>{i.stopPropagation(),g(i,"dragging_right",{taskId:o().id})},I(i=>{var v=`translate(${o().x}px, ${o().y}px)`,h=`${o().width}px`,x=`${o().height}px`,w=s()?"grabbing":"grab",b=c(),L=`${o().height}px`;return v!==i.e&&d(n,"transform",i.e=v),h!==i.t&&d(n,"width",i.t=h),x!==i.a&&d(n,"height",i.a=x),w!==i.o&&d(n,"cursor",i.o=w),b!==i.i&&d(n,"background",i.i=b),L!==i.n&&d(n,"line-height",i.n=L),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),n})()}function Ut(l){const r=K(),a=()=>typeof l.task=="function"?l.task():l.task,o=$(()=>{const t=a(),e=t==null?void 0:t.$bar,i=(t==null?void 0:t.progress)??0,v=(e==null?void 0:e.width)??40;return{colorBg:(t==null?void 0:t.color_bg)??"rgba(59,130,246,0.15)",colorFill:(t==null?void 0:t.color_fill)??"rgba(59,130,246,0.3)",locked:(t==null?void 0:t.locked)??!1,name:(t==null?void 0:t.name)??"",id:(t==null?void 0:t.id)??"",x:(e==null?void 0:e.x)??0,y:(e==null?void 0:e.y)??0,width:v,height:(e==null?void 0:e.height)??T,pw:v*i/100}}),c=()=>{const t=o(),e=t.pw;return`linear-gradient(to right, ${t.colorFill} 0px, ${t.colorFill} ${e}px, ${t.colorBg} ${e}px, ${t.colorBg} 100%)${t.locked?", repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(0,0,0,0.15) 3px, rgba(0,0,0,0.15) 6px)":""}`},{isDragging:s,startDrag:g}=F({onDragStart:()=>{},onDragMove:()=>{},onDragEnd:()=>{}}),n=t=>{const e=t.currentTarget.getBoundingClientRect(),i=t.clientX-e.left,v=e.width;i<=6?g(t,"dragging_left",{taskId:o().id}):i>=v-6?g(t,"dragging_right",{taskId:o().id}):g(t,"dragging_bar",{taskId:o().id})};return(()=>{var t=It();return t.$$mousedown=n,t.$$click=e=>{var i;return(i=r.onTaskClick)==null?void 0:i.call(r,o().id,e)},t.addEventListener("mouseleave",()=>{var e;return(e=r.onHoverEnd)==null?void 0:e.call(r)}),t.addEventListener("mouseenter",e=>{var i;return(i=r.onHover)==null?void 0:i.call(r,o().id,e.clientX,e.clientY)}),p(t,()=>o().name),I(e=>{var i=`translate(${o().x}px, ${o().y}px)`,v=`${o().width}px`,h=`${o().height}px`,x=s()?"grabbing":"grab",w=c(),b=`${o().height}px`;return i!==e.e&&d(t,"transform",e.e=i),v!==e.t&&d(t,"width",e.t=v),h!==e.a&&d(t,"height",e.a=h),x!==e.o&&d(t,"cursor",e.o=x),w!==e.i&&d(t,"background",e.i=w),b!==e.n&&d(t,"line-height",e.n=b),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),t})()}const Nt={minimal:xt,text:Ot,handles:Yt,reactive:Ft,drag:Xt,events:Gt,full:Vt,experiments:jt,nochildren:Ut};function qt(){const[l]=$t(Z),r=new URLSearchParams(window.location.search),a=r.get("bar")||"minimal";r.get("virt");const o=r.get("test"),c=r.get("grid")==="1",s=r.get("headers")==="1",g=r.get("resources")==="1",n=r.get("context")==="1"||["events","full"].includes(a),t=Nt[a]||xt,e=it.map((u,f)=>({id:u,name:u,type:"resource",displayIndex:f})),i={displayResources:()=>e},v={barHeight:()=>T,padding:()=>W},[h,x]=O(1200),[w,b]=O(800),[L,G]=O(0),[A,ft]=O(0),P=$(()=>{const u=A(),f=Math.floor(u/(T+W)),C=Math.ceil((u+w())/(T+W))+ht;return{start:Math.max(0,f-ht),end:Math.min(C,Y)}}),D=$(()=>{const u=L();return{start:Math.max(0,u-ut),end:u+h()+ut}}),[S]=O(r.get("memos")==="1"?"active":"off"),at=$(()=>{const u=D(),f=P(),C=Math.floor(u.start/q),k=Math.floor(u.end/q),y={},E=[];for(let M=f.start;M<f.end;M++){const R=Pt[M]||{};for(let B=C;B<=k;B++)for(const m of R[B]||[])y[m]||(y[m]=!0,E.push(l[m]))}return E});$(()=>S()!=="mode1"?[]:D()),$(()=>S()!=="mode2"?[]:D()),$(()=>S()!=="mode3"?[]:D()),$(()=>S()!=="mode4"?[]:D()),$(()=>S()!=="mode5"?[]:D()),$(()=>S()!=="mode6"?[]:D()),$(()=>S()!=="mode7"?[]:D()),$(()=>S()!=="mode8"?[]:D()),$(()=>S()!=="mode9"?[]:D()),$(()=>S()!=="mode10"?[]:D());let V,j;bt(()=>{const u=()=>{V&&(x(V.clientWidth),b(V.clientHeight-40))};if(u(),window.addEventListener("resize",u),Ct(()=>window.removeEventListener("resize",u)),o&&j){const f=U-h(),C=tt-w();let k=0,y=0,E=1,M=1;const R=()=>{(o==="horizontal"||o==="both")&&(k+=E*150,k>=f?(E=-1,k=f):k<=0&&(E=1,k=0),j.scrollLeft=k),(o==="vertical"||o==="both")&&(y+=M*100,y>=C?(M=-1,y=C):y<=0&&(M=1,y=0),j.scrollTop=y),requestAnimationFrame(R)};requestAnimationFrame(R)}});const mt=u=>{G(u.target.scrollLeft),ft(u.target.scrollTop)},st=$(()=>{const u=L(),f=Math.floor(u/z),C=Math.ceil((u+h())/z)+2;return{start:Math.max(0,f-1),end:Math.min(C,N)}}),J=[];for(let u=0;u<N;u++){const f=new Date(nt.getTime()+u*24*60*60*1e3);J.push({x:u*z,width:z,upperText:u===0?et.format(f,"MMM YYYY"):f.getUTCDay()===1?`W${Math.ceil((u+1)/7)}`:"",lowerText:f.getUTCDate().toString(),isThickLine:f.getUTCDay()===1})}const pt=[c&&"grid",s&&"headers",g&&"resources",n&&"context"].filter(Boolean).join("+")||"none",dt=(()=>{var u=zt(),f=u.firstChild,C=f.firstChild,k=C.nextSibling;k.firstChild;var y=k.nextSibling;y.firstChild;var E=y.nextSibling;E.firstChild,E.nextSibling;var M=f.nextSibling,R=M.firstChild,B=R.firstChild;return gt(m=>V=m,u),p(k,a,null),p(y,pt,null),p(E,()=>at().length,null),p(M,_(Q,{when:g,get children(){var m=Bt(),lt=m.firstChild,ct=lt.nextSibling;return d(lt,"height",s?"75px":"0"),p(ct,_(yt,{resourceStore:i,ganttConfig:v,get startRow(){return P().start},get endRow(){return P().end}})),I(Kt=>d(ct,"transform",`translateY(-${A()}px)`)),m}}),R),R.addEventListener("scroll",mt),gt(m=>j=m,R),p(R,_(Q,{when:s,get children(){var m=Ht();return p(m,_(kt,{dateInfos:J,gridWidth:U,columnWidth:z,get startCol(){return st().start},get endCol(){return st().end}})),m}}),B),d(B,"width",`${U}px`),d(B,"height",`${tt}px`),p(B,_(Q,{when:c,get children(){var m=Lt();return p(m,_(Dt,{width:U,height:tt,columnWidth:z,dateInfos:J,barHeight:T,padding:W,taskCount:Y,get startRow(){return P().start},get endRow(){return P().end},resourceStore:i})),m}}),null),p(B,_(Tt,{get each(){return at()},children:m=>_(t,{task:m})}),null),u})();return n?_(St,{children:dt}):dt}wt(["mousedown","click"]);Et(()=>_(qt,{}),document.getElementById("app"));
