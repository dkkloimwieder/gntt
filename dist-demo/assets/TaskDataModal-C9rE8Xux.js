import{b as h,m as M,t as F,i as x,g as N,y as U,S as O,c as B,j as T,l as K}from"./calendar-C_HCiwEi.js";function Y(e,n){var t;if(!e)return"";const o=[`Task: "${e.name||"Unnamed"}"`,`ID: ${e.id}`,`Progress: ${e.progress??0}%`];return n&&(o.push(`Position: (${Math.round(n.x)}, ${Math.round(n.y)})`),o.push(`Size: ${Math.round(n.width)} x ${Math.round(n.height)}`)),(t=e.constraints)!=null&&t.locked&&o.push("Status: Locked"),e.invalid&&o.push("Status: Invalid"),o.join(`
`)}function q(e,n,o=[]){if(!e)return null;const t={...e};return delete t.$bar,{sections:{rawTask:JSON.stringify(t,null,2),position:n?JSON.stringify({x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height),index:n.index},null,2):"N/A",relationships:Q(e.id,o)},raw:JSON.stringify({task:t,position:n},null,2)}}const G={FS:"Finish-to-Start",SS:"Start-to-Start",FF:"Finish-to-Finish",SF:"Start-to-Finish"};function _(e,n,o){const t=G[e.type]||e.type,i=e.lag??0,l=i?`, lag: ${i} day${i!==1?"s":""}`:"";return`  ${e.type} ${o} ${n} (${t}${l})`}function Q(e,n){if(!n||n.length===0)return"No relationships defined";const o=n.filter(l=>l.to===e),t=n.filter(l=>l.from===e);let i="";return o.length===0?i+=`Incoming: (none)
`:(i+=`Incoming:
`,o.forEach(l=>{i+=_(l,l.from,"<-")+`
`})),t.length===0?i+="Outgoing: (none)":(i+=`Outgoing:
`,t.forEach((l,c)=>{i+=_(l,l.to,"->"),c<t.length-1&&(i+=`
`)})),i}function z(e){return e?e.replace(/"([^"]+)":/g,'<span style="color: #9b59b6;">"$1"</span>:').replace(/: "([^"]+)"/g,': <span style="color: #27ae60;">"$1"</span>').replace(/: (-?\d+\.?\d*)/g,': <span style="color: #e74c3c;">$1</span>').replace(/: (true|false)/g,': <span style="color: #3498db;">$1</span>').replace(/: (null)/g,': <span style="color: #95a5a6;">$1</span>'):""}var V=F('<div><div style=font-family:monospace;white-space:pre-line;line-height:1.5></div><div style="margin-top:10px;padding-top:8px;border-top:1px solid #eee;font-size:10px;color:#999;text-align:center;font-family:sans-serif">Click for full data');function Z(e){const n=h(()=>{var l,c;const t=(l=e.task)==null?void 0:l.call(e),i=(c=e.barPosition)==null?void 0:c.call(e);return t?Y(t,i):""}),o=h(()=>{var i;const t=((i=e.position)==null?void 0:i.call(e))||{x:0,y:0};return{position:"fixed",left:`${t.x+15}px`,top:`${t.y-10}px`,background:"#fff","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","border-radius":"6px",padding:"12px","min-width":"180px","max-width":"280px","z-index":1100,"font-size":"12px","border-left":"3px solid #3498db","pointer-events":"none"}});return M(O,{get when(){var t;return(t=e.visible)==null?void 0:t.call(e)},get children(){var t=V(),i=t.firstChild;return i.nextSibling,x(i,n),N(l=>U(t,o(),l)),t}})}var W=F('<div tabindex=-1 style=position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:2000><div style="background:#fff;border-radius:8px;width:90%;max-width:600px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 10px 40px rgba(0,0,0,0.3)"><div style="display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #eee;flex-shrink:0"><h3 style=margin:0;font-size:16px;font-weight:600>Task Data: </h3><button title="Close (Esc)"style="border:none;background:none;font-size:24px;cursor:pointer;padding:4px 8px;color:#666;line-height:1">&times;</button></div><div style=padding:20px;overflow:auto;flex:1><div style=margin-bottom:20px><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:8px><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px>Raw Task Object</span><button style="padding:4px 10px;border:none;border-radius:3px;cursor:pointer;font-size:11px;transition:background 0.2s"></button></div><pre style=background:#f8f9fa;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;white-space:pre-wrap;word-break:break-all;overflow:auto;max-height:200px;margin:0;line-height:1.5></pre></div><div style=margin-bottom:20px><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px;display:block;margin-bottom:8px>Computed Position ($bar)</span><pre style=background:#f8f9fa;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;margin:0;line-height:1.5></pre></div><div><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px;display:block;margin-bottom:8px>Relationships</span><pre style=background:#fff8e1;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;white-space:pre-wrap;margin:0;line-height:1.5;color:#5d4037>');function P(e){const[n,o]=B(""),t=h(()=>{var s,g,f;const a=(s=e.task)==null?void 0:s.call(e);return a?q(a,(g=e.barPosition)==null?void 0:g.call(e),((f=e.relationships)==null?void 0:f.call(e))||[]):null}),i=async()=>{const a=t();if(a!=null&&a.raw)try{await navigator.clipboard.writeText(a.raw),o("Copied!"),setTimeout(()=>o(""),2e3)}catch{o("Failed to copy"),setTimeout(()=>o(""),2e3)}},l=a=>{var s;a.target===a.currentTarget&&((s=e.onClose)==null||s.call(e))},c=a=>{var s;a.key==="Escape"&&((s=e.onClose)==null||s.call(e))};return M(O,{get when(){var a;return(a=e.visible)==null?void 0:a.call(e)},get children(){var a=W(),s=a.firstChild,g=s.firstChild,f=g.firstChild;f.firstChild;var E=f.nextSibling,D=g.nextSibling,y=D.firstChild,m=y.firstChild,R=m.firstChild,u=R.nextSibling,j=m.nextSibling,b=y.nextSibling,J=b.firstChild,I=J.nextSibling,L=b.nextSibling,A=L.firstChild,H=A.nextSibling;return a.$$keydown=c,a.$$click=l,x(f,()=>{var r,d;return((d=(r=e.task)==null?void 0:r.call(e))==null?void 0:d.name)||"Unknown"},null),E.$$click=()=>{var r;return(r=e.onClose)==null?void 0:r.call(e)},u.$$click=i,x(u,()=>n()||"Copy JSON"),x(H,()=>{var r,d;return(d=(r=t())==null?void 0:r.sections)==null?void 0:d.relationships}),N(r=>{var w,k,S,C;var d=n()==="Copied!"?"#d4edda":"#e3f2fd",$=n()==="Copied!"?"#155724":"#1976d2",p=z(((k=(w=t())==null?void 0:w.sections)==null?void 0:k.rawTask)||""),v=z(((C=(S=t())==null?void 0:S.sections)==null?void 0:C.position)||"");return d!==r.e&&T(u,"background",r.e=d),$!==r.t&&T(u,"color",r.t=$),p!==r.a&&(j.innerHTML=r.a=p),v!==r.o&&(I.innerHTML=r.o=v),r},{e:void 0,t:void 0,a:void 0,o:void 0}),a}})}K(["click","keydown"]);export{Z as T,P as a};
