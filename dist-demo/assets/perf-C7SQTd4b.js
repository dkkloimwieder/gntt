import{c as L,o as xe,a as no,r as Ae,p as Le,d as Z,b as z,u as oo,e as Ue,f as Dt,t as $t,i as it,g as wt,h as ye,s as lt,j as N,k as Be,l as ae,m as vt,S as Ce,F as Oe,n as Ft,I as be,q as ot,v as pe,G as so,w as we,D as ro,R as ao,x as io,y as lo,z as co,A as uo}from"./calendar-K225rnsu.js";import{G as go}from"./GanttContainer-UOquHELm.js";function fo(t){const[e,o]=L(!1);let n=0;const s=a=>{n=requestAnimationFrame(s),t(a)},r=()=>{e()||(o(!0),n=requestAnimationFrame(s))},i=()=>{o(!1),cancelAnimationFrame(n)};return xe(i),[e,r,i]}const Yt=new Map;let Jt=!1,zt=[];function Ge(t){if(!Jt)return()=>{};const e=performance.now(),o=zt.length>0?zt[zt.length-1]:null;return zt.push(t),function(){const s=performance.now()-e;zt.pop(),Yt.has(t)||Yt.set(t,{name:t,calls:0,totalTime:0,selfTime:0,minTime:1/0,maxTime:0,parent:new Map});const r=Yt.get(t);if(r.calls++,r.totalTime+=s,r.selfTime+=s,r.minTime=Math.min(r.minTime,s),r.maxTime=Math.max(r.maxTime,s),o){const i=Yt.get(o);i&&(i.selfTime-=s),r.parent.set(o,(r.parent.get(o)||0)+1)}}}function ho(t,e){if(!Jt)return e();const o=Ge(t);try{return e()}finally{o()}}function mo(){Jt=!0,console.log("[Profiler] Enabled")}function vo(){Jt=!1,console.log("[Profiler] Disabled")}function xo(){Yt.clear(),zt=[]}function yo(){return Jt}function Je(){return Array.from(Yt.values()).map(t=>({...t,avgTime:t.calls>0?t.totalTime/t.calls:0,minTime:t.minTime===1/0?0:t.minTime,parent:Object.fromEntries(t.parent)})).sort((t,e)=>e.totalTime-t.totalTime)}function Ke(){const t=Je();if(t.length===0)return"No profiling data. Call prof.enable() then interact with the chart.";const e=["","=".repeat(90),"FUNCTION PROFILER REPORT","=".repeat(90),"","Function                              Calls     Total(ms)   Self(ms)    Avg(ms)    Max(ms)","-".repeat(90)];for(const o of t){const n=o.name.padEnd(36).slice(0,36),s=String(o.calls).padStart(8),r=o.totalTime.toFixed(2).padStart(12),i=o.selfTime.toFixed(2).padStart(10),a=o.avgTime.toFixed(3).padStart(10),g=o.maxTime.toFixed(2).padStart(10);e.push(`${n} ${s} ${r} ${i} ${a} ${g}`)}e.push("-".repeat(90)),e.push(""),e.push("CALL RELATIONSHIPS:");for(const o of t.slice(0,15)){const n=Object.entries(o.parent);n.length>0&&e.push(`  ${o.name} <- ${n.map(([s,r])=>`${s}(${r})`).join(", ")}`)}return e.push(""),e.join(`
`)}function bo(){console.log(Ke())}const Qe={start:Ge,time:ho,enable:mo,disable:vo,clear:xo,isEnabled:yo,getData:Je,report:Ke,log:bo};typeof window<"u"&&(window.prof=Qe);function po(){const[t,e]=no({}),[o,n]=L(new Set),[s,r]=L(null);return{tasks:t,getTask:R=>t[R],getBarPosition:R=>{const l=Qe.start("taskStore.getBarPosition"),h=t[R];if(!h||!h.$bar)return l(),null;const X={x:h.$bar.x,y:h.$bar.y,width:h.$bar.width,height:h.$bar.height,index:h._index};return l(),X},getAllTasks:()=>Object.values(t),taskCount:()=>Object.keys(t).length,updateTask:(R,l)=>{e(R,l)},updateBarPosition:(R,l)=>{t[R]&&e(Le(h=>{h[R]&&(h[R].$bar={...h[R].$bar,...l})}))},updateTasks:R=>{const l={};R.forEach(h=>{l[h.id]=h}),e(Ae(l))},batchMovePositions:(R,l)=>{e(Le(h=>{var X;for(const[$,{originalX:U}]of R)(X=h[$])!=null&&X.$bar&&(h[$].$bar.x=U+l)}))},removeTask:R=>{e(R,void 0)},clear:()=>{e(Ae({}))},collapsedTasks:o,toggleTaskCollapse:R=>{n(l=>{const h=new Set(l);return h.has(R)?h.delete(R):h.add(R),h})},isTaskCollapsed:R=>o().has(R),expandTask:R=>{n(l=>{if(!l.has(R))return l;const h=new Set(l);return h.delete(R),h})},collapseTask:R=>{n(l=>{if(l.has(R))return l;const h=new Set(l);return h.add(R),h})},expandAllTasks:()=>{n(new Set)},collapseAllTasks:()=>{const R=[];for(const l of Object.values(t))(l.type==="summary"||l._children&&l._children.length>0)&&R.push(l.id);n(new Set(R))},draggingTaskId:s,setDraggingTaskId:r}}function wo(t={}){const[e,o]=L(t.ganttStart||new Date),[n,s]=L(t.ganttEnd||new Date),[r,i]=L(t.unit||"day"),[a,g]=L(t.step||1),[d,b]=L(t.columnWidth||t.column_width||45),[m,E]=L(t.barHeight||t.bar_height||30),[H,v]=L(t.headerHeight||75),[_,u]=L(t.padding||18),[c,x]=L(t.barCornerRadius||t.bar_corner_radius||3),[w,D]=L(t.readonly||!1),[Y,R]=L(t.readonlyDates||!1),[l,h]=L(t.readonlyProgress||!1),[X,$]=L(t.showExpectedProgress||!1),[U,K]=L(t.autoMoveLabel||!1),[tt,k]=L(t.ignoredDates||[]),[p,C]=L(t.ignoredFunction||null),[T,F]=L([]),[B,G]=L(t.subtaskHeightRatio||.5),[j,V]=L(t.renderMode||"simple"),[rt,W]=L(new Set(t.expandedTasks||[]));return{ganttStart:e,ganttEnd:n,unit:r,step:a,columnWidth:d,barHeight:m,headerHeight:H,padding:_,barCornerRadius:c,readonly:w,readonlyDates:Y,readonlyProgress:l,showExpectedProgress:X,autoMoveLabel:U,ignoredDates:tt,ignoredFunction:p,ignoredPositions:T,subtaskHeightRatio:B,renderMode:j,expandedTasks:rt,setGanttStart:o,setGanttEnd:s,setUnit:i,setStep:g,setColumnWidth:b,setBarHeight:E,setHeaderHeight:v,setPadding:u,setBarCornerRadius:x,setReadonly:D,setReadonlyDates:R,setReadonlyProgress:h,setShowExpectedProgress:$,setAutoMoveLabel:K,setIgnoredDates:k,setIgnoredFunction:C,setIgnoredPositions:F,setSubtaskHeightRatio:G,setRenderMode:V,setExpandedTasks:W,isTaskExpanded:S=>rt().has(S),toggleTaskExpansion:S=>{W(et=>{const st=new Set(et);return st.has(S)?st.delete(S):st.add(S),st})},expandTask:S=>{W(et=>{if(et.has(S))return et;const st=new Set(et);return st.add(S),st})},collapseTask:S=>{W(et=>{if(!et.has(S))return et;const st=new Set(et);return st.delete(S),st})},expandAllTasks:S=>{W(new Set(S))},collapseAllTasks:()=>{W(new Set)},updateOptions:S=>{S.ganttStart!==void 0&&o(S.ganttStart),S.ganttEnd!==void 0&&s(S.ganttEnd),S.unit!==void 0&&i(S.unit),S.step!==void 0&&g(S.step),S.columnWidth!==void 0&&b(S.columnWidth),S.barHeight!==void 0&&E(S.barHeight),S.headerHeight!==void 0&&v(S.headerHeight),S.padding!==void 0&&u(S.padding),S.barCornerRadius!==void 0&&x(S.barCornerRadius),S.readonly!==void 0&&D(S.readonly),S.readonlyDates!==void 0&&R(S.readonlyDates),S.readonlyProgress!==void 0&&h(S.readonlyProgress),S.showExpectedProgress!==void 0&&$(S.showExpectedProgress),S.autoMoveLabel!==void 0&&K(S.autoMoveLabel),S.ignoredDates!==void 0&&k(S.ignoredDates),S.ignoredFunction!==void 0&&C(S.ignoredFunction),S.ignoredPositions!==void 0&&F(S.ignoredPositions),S.subtaskHeightRatio!==void 0&&G(S.subtaskHeightRatio),S.renderMode!==void 0&&V(S.renderMode),S.expandedTasks!==void 0&&W(new Set(S.expandedTasks))},getConfig:()=>({ganttStart:e(),ganttEnd:n(),unit:r(),step:a(),columnWidth:d(),barHeight:m(),headerHeight:H(),padding:_(),barCornerRadius:c(),readonly:w(),readonlyDates:Y(),readonlyProgress:l(),showExpectedProgress:X(),autoMoveLabel:U(),ignoredDates:tt(),ignoredFunction:p(),ignoredPositions:T(),subtaskHeightRatio:B(),renderMode:j(),expandedTasks:rt()})}}function ve(t){const e=t.getFullYear();return e-e%10+""}function ko(t,e,o){let n=Z.add(t,6,"day"),s=n.getMonth()!==t.getMonth()?"D MMM":"D",r=!e||t.getMonth()!==e.getMonth()?"D MMM":"D";return`${Z.format(t,r,o)} - ${Z.format(n,s,o)}`}const oe=[{name:"Minute",padding:"1h",step:"1min",column_width:20,date_format:"YYYY-MM-DD HH:mm",lower_text:"mm",upper_text:(t,e,o)=>!e||t.getHours()!==e.getHours()?Z.format(t,"D MMM HH:00",o):"",upper_text_frequency:60},{name:"Quarter Hour",padding:"6h",step:"15min",column_width:30,date_format:"YYYY-MM-DD HH:mm",lower_text:"mm",upper_text:(t,e,o)=>!e||t.getHours()!==e.getHours()?Z.format(t,"D MMM HH:00",o):"",upper_text_frequency:4},{name:"Hour",padding:"7d",step:"1h",date_format:"YYYY-MM-DD HH:",lower_text:"HH",upper_text:(t,e,o)=>!e||t.getDate()!==e.getDate()?Z.format(t,"D MMMM",o):"",upper_text_frequency:24},{name:"Quarter Day",padding:"7d",step:"6h",date_format:"YYYY-MM-DD HH:",lower_text:"HH",upper_text:(t,e,o)=>!e||t.getDate()!==e.getDate()?Z.format(t,"D MMM",o):"",upper_text_frequency:4},{name:"Half Day",padding:"14d",step:"12h",date_format:"YYYY-MM-DD HH:",lower_text:"HH",upper_text:(t,e,o)=>!e||t.getDate()!==e.getDate()?t.getMonth()!==t.getMonth()?Z.format(t,"D MMM",o):Z.format(t,"D",o):"",upper_text_frequency:2},{name:"Day",padding:"7d",date_format:"YYYY-MM-DD",step:"1d",lower_text:(t,e,o)=>!e||t.getDate()!==e.getDate()?Z.format(t,"D",o):"",upper_text:(t,e,o)=>!e||t.getMonth()!==e.getMonth()?Z.format(t,"MMMM",o):"",thick_line:t=>t.getDay()===1},{name:"Week",padding:"1m",step:"7d",date_format:"YYYY-MM-DD",column_width:140,lower_text:ko,upper_text:(t,e,o)=>!e||t.getMonth()!==e.getMonth()?Z.format(t,"MMMM",o):"",thick_line:t=>t.getDate()>=1&&t.getDate()<=7,upper_text_frequency:4},{name:"Month",padding:"2m",step:"1m",column_width:120,date_format:"YYYY-MM",lower_text:"MMMM",upper_text:(t,e,o)=>!e||t.getFullYear()!==e.getFullYear()?Z.format(t,"YYYY",o):"",thick_line:t=>t.getMonth()%3===0,snap_at:"7d"},{name:"Year",padding:"2y",step:"1y",column_width:120,date_format:"YYYY",upper_text:(t,e,o)=>!e||ve(t)!==ve(e)?ve(t):"",lower_text:"YYYY",snap_at:"30d"}];function So(t={}){const[e,o]=L(t.ganttStart||new Date),[n,s]=L(t.ganttEnd||new Date),[r,i]=L([]),a=oe.find(k=>k.name==="Day")||oe[3],g=t.viewMode||t.view_mode,d=g&&oe.find(k=>k.name===g)||a,[b,m]=L(d),[E]=L(t.viewModes||oe),[H,v]=L(t.language||"en"),_=z(()=>r().length),u=z(()=>{const k=b();return Z.parse_duration(k.step)}),c=z(()=>u().scale),x=z(()=>u().duration),[w]=L(t.columnWidth||t.column_width||null),D=z(()=>w()||b().column_width||45),Y=z(()=>_()*D()),R=(k,p=!1)=>{if(!k||k.length===0){const W=Z.today(),J=b(),{duration:ut,scale:gt}=Z.parse_duration(J.padding||"7d"),kt=Z.add(W,-ut,gt),pt=Z.add(W,ut,gt);o(Z.start_of(kt,c())),s(pt),l();return}let C=null,T=null;for(const W of k){const J=W._start||Z.parse(W.start),ut=W._end||Z.parse(W.end);(!C||J<C)&&(C=J),(!T||ut>T)&&(T=ut)}const F=b(),{duration:B,scale:G}=Z.parse_duration(F.padding||"7d");let j=Z.add(C,-B,G),V=Z.add(T,B,G);p&&(j=Z.add(j,-30,c()),V=Z.add(V,30,c())),j=Z.start_of(j,c());const rt=c();rt!=="hour"&&rt!=="minute"&&j.setHours(0,0,0,0),o(j),s(V),l()},l=()=>{const k=e(),p=n(),C=x(),T=c(),F=[];let B=new Date(k);for(;B<p;)F.push(new Date(B)),B=Z.add(B,C,T);i(F)},h=(k,p=10)=>{const C=x(),T=c();if(k==="left"){const F=Z.add(e(),-p*C,T);o(F)}else{const F=Z.add(n(),p*C,T);s(F)}l()},X=k=>{if(typeof k=="string"){const p=E().find(C=>C.name===k);p&&(m(p),l())}else k&&k.name&&(m(k),l())},$=(k,p,C=null)=>{const T=b(),F=H(),B=D(),G=p*B;let j="";typeof T.lower_text=="function"?j=T.lower_text(k,C,F):typeof T.lower_text=="string"&&(j=Z.format(k,T.lower_text,F));let V="";typeof T.upper_text=="function"?V=T.upper_text(k,C,F):typeof T.upper_text=="string"&&(V=Z.format(k,T.upper_text,F));const rt=T.thick_line?T.thick_line(k):!1;return{date:k,x:G,width:B,lowerText:j,upperText:V,isThickLine:rt}},U=z(()=>{const k=r(),p=[];let C=null;for(let T=0;T<k.length;T++){const F=$(k[T],T,C);p.push(F),C=k[T]}return p});return{ganttStart:e,ganttEnd:n,dates:r,viewMode:b,viewModes:E,language:H,setGanttStart:o,setGanttEnd:s,setViewMode:X,setLanguage:v,dateCount:_,unit:c,step:x,columnWidth:D,gridWidth:Y,getAllDateInfos:U,setupDates:R,generateDates:l,extendTimeline:h,changeViewMode:X,getDateInfo:$,dateToX:k=>{const p=e(),C=x(),T=c(),F=D();return Z.diff(k,p,T)/C*F},xToDate:k=>{const p=e(),C=x(),T=c(),F=D(),B=k/F*C;return Z.add(p,B,T)}}}function We(t){return!t||t.length===0?[]:t.map(e=>typeof e=="object"&&e!==null?{...e,id:e.id||e.name||String(e),type:e.type||"resource",group:e.group||null}:{id:String(e),type:"resource",group:null})}function Co(t,e){const o=[];for(const n of t){if(n.type==="group"){o.push({...n,displayIndex:o.length,isCollapsed:e.has(n.id)});continue}n.group&&e.has(n.group)||o.push({...n,displayIndex:o.length})}return o}function To(t){if(!t||t.length===0)return[];const e=new Set,o=[];for(const n of t){const s=n.resource||"Unassigned";e.has(s)||(e.add(s),o.push({id:s,type:"resource",group:null}))}return o}function Mo(t=[]){const[e,o]=L(We(t)),[n,s]=L(new Set),r=z(()=>Co(e(),n())),i=z(()=>{const u=new Map,c=r();for(let x=0;x<c.length;x++)u.set(c[x].id,x);return u}),a=z(()=>r().length),g=u=>{s(c=>{const x=new Set(c);return x.has(u)?x.delete(u):x.add(u),x})},d=u=>{s(c=>{const x=new Set(c);return x.delete(u),x})},b=u=>{s(c=>{const x=new Set(c);return x.add(u),x})},m=u=>n().has(u),E=u=>{o(We(u))},H=z(()=>e().filter(u=>u.type==="group"));return{resources:e,collapsedGroups:n,displayResources:r,resourceIndexMap:i,displayCount:a,getGroups:H,updateResources:E,toggleGroup:g,expandGroup:d,collapseGroup:b,isGroupCollapsed:m,expandAll:()=>{s(new Set)},collapseAll:()=>{const u=H();s(new Set(u.map(c=>c.id)))}}}function _o(t,e,o,n,s){return Z.diff(t,e,o)/n*s}function $o(t,e,o){const n=e+o;return t*n+o/2}function Do(t,e,o,n,s){return Z.diff(e,t,o)/n*s}function ze(t,e,o,n=[],s=45){const r=t+e,i=new Set(n.map(H=>Math.floor(H/s))),g=n.reduce((H,v)=>H+(v>=t&&v<r?1:0),0)*s;let d=(e-g)*o/100;const b=t+d,m=n.reduce((H,v)=>H+(v>=t&&v<b?1:0),0);d+=m*s;let E=t+d;for(;E<r;){const H=Math.floor(E/s);if(i.has(H))d+=s,E=t+d;else break}return Math.min(d,e)}function Ho(t,e,o,n){const s=Z.today(),r=Z.diff(e,t,"hour")/n,i=Z.diff(s,t,"hour")/n,a=Math.min(i,r);return r>0?a*100/r:0}function Ro(t,e,o){return e.some(n=>t>=n&&t<n+o)}function ke(t,e,o=[]){let n=Math.round(t/e)*e;for(;Ro(n,o,e);)n+=e;return n}function Ze(t,e,o,n=7){return o.length*n+10<e?{x:t+e/2,position:"inside"}:{x:t+e+5,position:"outside"}}function Fo(t,e,o=20){if(!t._children||t._children.length===0)return null;const n=e.get?d=>e.get(d):d=>e[d],s=[],r=d=>{for(const b of d){const m=n(b);m!=null&&m.$bar&&(s.push(m.$bar),m._children&&m._children.length>0&&r(m._children))}};if(r(t._children),s.length===0)return null;const i=Math.min(...s.map(d=>d.x)),a=Math.max(...s.map(d=>d.x+d.width)),g=Math.max(a-i,o);return{x:i,width:g}}function Po(t){let e=0;for(const o of t.values())o._depth>e&&(e=o._depth);for(let o=e;o>=0;o--)for(const n of t.values())if(n._depth===o&&n.type==="summary"){const s=Fo(n,t);s&&n.$bar&&(n.$bar.x=s.x,n.$bar.width=s.width)}}const _t={FS:"FS",SS:"SS",FF:"FF",SF:"SF"},re=0;function Eo(t){const e=new Map,o=new Set;for(const r of t){const i=r.from??r.predecessorId,a=r.to??r.successorId;!i||!a||(o.add(i),o.add(a),e.has(i)||e.set(i,[]),e.get(i).push(a))}const n=new Map,s=new Map;for(const r of o)n.set(r,0);for(const r of o){if(n.get(r)!==0)continue;const i=[{node:r,iterator:null}];for(n.set(r,1);i.length>0;){const a=i[i.length-1],g=e.get(a.node)||[];a.iterator===null&&(a.iterator=0);let d=!1;for(;a.iterator<g.length;){const b=g[a.iterator];a.iterator++;const m=n.get(b);if(m===1){const E=[b];for(let H=i.length-1;H>=0&&(E.unshift(i[H].node),i[H].node!==b);H--);return{hasCycle:!0,cycle:E}}if(m===0){n.set(b,1),s.set(b,a.node),i.push({node:b,iterator:null}),d=!0;break}}d||(n.set(a.node,2),i.pop())}}return{hasCycle:!1,cycle:null}}function Io(t,e,o=new Set){const n=[],s=[t];for(;s.length>0;){const r=s.shift();if(!o.has(r)){o.add(r);for(const i of e)i.elastic===!1&&(i.from===r&&!o.has(i.to)&&(n.push({taskId:i.to,relationship:i}),s.push(i.to)),i.to===r&&!o.has(i.from)&&(n.push({taskId:i.from,relationship:i}),s.push(i.from)))}}return n}function Xt(t,e,o,n,s=null){const r=s??e.$bar.x,i=e.$bar.width,a=o.$bar.width;switch(t){case _t.FS:return r+i+n;case _t.SS:return r+n;case _t.FF:return r+i-a+n;case _t.SF:return r-a+n;default:return r+i+n}}function Ao(t,e,o,n,s=null){return Xt(t,e,o,n,s)}function Lo(t,e,o,n,s){const r=Xt(t,e,o,n,s),i=o.$bar.x;return i<r?r-i:0}function Te(t,e,o,n,s,r={},i=new Set){var m,E;if(i.has(t))return console.warn(`Cycle detected in dependency chain involving task: ${t}`),null;const a=new Set(i);a.add(t);const{pixelsPerTimeUnit:g=1}=r,d=n.getTask(t);if(!d||(m=d.constraints)!=null&&m.locked)return null;const b=Io(t,s);if(b.length>0){if(b.some(c=>{var w;const x=n.getTask(c.taskId);return(w=x==null?void 0:x.constraints)==null?void 0:w.locked}))return null;const v=e-d.$bar.x,_=o-d.$bar.y,u=[{taskId:t,x:e,y:o}];return b.forEach(c=>{const x=n.getTask(c.taskId);x&&u.push({taskId:c.taskId,x:x.$bar.x+v,y:x.$bar.y+_})}),{type:"batch",updates:u}}for(const H of s){if(H.elastic===!1)continue;const v=H.from===t,_=H.to===t;if(!v&&!_)continue;const u=v?H.to:H.from,c=n.getTask(u);if(!c)continue;const x=H.type||_t.FS,D=(H.lag??re)*g;if(v){const Y=Lo(x,d,c,D,e);if(Y>0)if((E=c.constraints)!=null&&E.locked){const R=Bo(x,d,c,D,c.$bar.x);e=Math.min(e,R)}else{const R=c.$bar.x+Y,l=Te(u,R,c.$bar.y,n,s,r,a);(l==null?void 0:l.type)==="single"?n.updateBarPosition(u,{x:l.x,y:l.y}):(l==null?void 0:l.type)==="batch"&&l.updates.forEach(h=>{n.updateBarPosition(h.taskId,{x:h.x,y:h.y})})}}else{const R=Xt(x,c,d,D);e<R&&(e=R)}}return{type:"single",taskId:t,x:e,y:o}}function Bo(t,e,o,n,s){const r=e.$bar.width,i=o.$bar.width;switch(t){case _t.FS:return s-r-n;case _t.SS:return s-n;case _t.FF:return s-r+i-n;case _t.SF:return s+i-n;default:return s-r-n}}function Wo(t,e,o,n,s={}){if(e>=0)return e;const{pixelsPerTimeUnit:r=1}=s;let i=e;const a=new Set(t.keys());for(const[g,{originalX:d}]of t){const b=n(g);if(b!=null&&b.$bar)for(const m of o){if(m.to!==g)continue;const E=m.from;if(a.has(E))continue;const H=n(E);if(!(H!=null&&H.$bar))continue;const v=m.type||_t.FS,u=(m.lag??re)*r,c=Xt(v,H,b,u);if(d+e<c){const w=c-d;w<=0?i=Math.max(i,w):i=Math.max(i,0)}}}return i}function zo(t,e,o=null,n=new Set){var r;const s=[t];for(;s.length>0;){const i=s.shift();if(!n.has(i)){if(o){const a=o(i);if((r=a==null?void 0:a.constraints)!=null&&r.locked)continue}n.add(i);for(const a of e)a.from===i&&!n.has(a.to)&&s.push(a.to)}}return n}function Yo(t,e,o,n={}){var i;const{pixelsPerTimeUnit:s=1}=n,r=e.getTask(t);if(r){for(const a of o){if(a.from!==t)continue;const g=e.getTask(a.to);if(!g||(i=g.constraints)!=null&&i.locked)continue;const d=a.type||_t.FS,m=(a.lag??re)*s;if(a.elastic!==!1){const H=Xt(d,r,g,m);if(g.$bar.x<H){const v=Te(a.to,H,g.$bar.y,e,o,n,new Set([t]));(v==null?void 0:v.type)==="single"?e.updateBarPosition(a.to,{x:v.x,y:v.y}):(v==null?void 0:v.type)==="batch"&&v.updates.forEach(_=>{e.updateBarPosition(_.taskId,{x:_.x,y:_.y})})}}else{const H=Ao(d,r,g,m);e.updateBarPosition(a.to,{x:H})}}for(const a of o){if(a.to!==t||a.type!==_t.FF&&a.type!==_t.SF)continue;const g=e.getTask(a.from);if(!g)continue;const d=a.type,m=(a.lag??re)*s,E=Xt(d,g,r,m);r.$bar.x<E&&e.updateBarPosition(t,{x:E})}}}function Xo(t,e){return`task-${t.name||""}-${e}-${Date.now()}`.replace(/\s+/g,"-")}function qo(t){return t?typeof t=="object"&&!Array.isArray(t)?[{id:t.id,type:t.type||"FS",lag:t.lag||0}]:typeof t=="string"?t.split(",").map(e=>e.trim()).filter(e=>e.length>0).map(e=>({id:e,type:"FS",lag:0})):Array.isArray(t)?t.filter(e=>e).map(e=>typeof e=="string"?{id:e,type:"FS",lag:0}:{id:e.id,type:e.type||"FS",lag:e.lag||0}):[]:[]}function Vo(t,e){const o={...t};if(o.id||(o.id=Xo(t,e)),o._start=Z.parse(t.start),t.end)o._end=Z.parse(t.end);else if(t.duration){const{duration:s,scale:r}=Z.parse_duration(t.duration);o._end=Z.add(o._start,s,r)}else o._end=new Date(o._start);return Z.diff(o._end,o._start,"year")>10?(console.error(`Task "${o.name}" has duration > 10 years`),null):(o._end<o._start&&(console.warn(`Task "${o.name}" has end before start, swapping`),[o._start,o._end]=[o._end,o._start]),o.dependencies=qo(t.dependencies),o._index=e,typeof o.progress!="number"&&(o.progress=0),o.progress=Math.max(0,Math.min(100,o.progress)),o.constraints={locked:!1,...t.constraints},t.parentId!==void 0&&(o.parentId=t.parentId),t.type!==void 0&&(o.type=t.type),o._children=[],o._depth=0,o)}function jo(t,e,o=null){const n=[],s=[];for(let d=0;d<t.length;d++){const b=Vo(t[d],d);b&&n.push(b)}const r=new Set,i=[];for(const d of n){const b=d.resource||"Unassigned";r.has(b)||(r.add(b),i.push(b))}let a;o?a=o:(a=new Map,i.forEach((d,b)=>a.set(d,b)));for(const d of n){const b=d.resource||"Unassigned",m=a.get(b),E=m!==void 0?m:-1,H=E<0,v=_o(d._start,e.ganttStart,e.unit,e.step,e.columnWidth),_=H?-1e3:$o(E,e.barHeight,e.padding),u=Do(d._start,d._end,e.unit,e.step,e.columnWidth);d.$bar={x:v,y:_,width:u,height:e.barHeight},d._resourceIndex=E,d._isHidden=H;for(const c of d.dependencies)n.find(w=>w.id===c.id)&&s.push({from:c.id,to:d.id,type:c.type||"FS",lag:c.lag||0,elastic:!0})}const g=Eo(s);return g.hasCycle&&console.warn(`Circular dependency detected: ${g.cycle.join(" â†’ ")}`,`
This may cause unexpected behavior during task dragging.`),{tasks:n,relationships:s,resources:i}}function No(t){let e=null,o=null;for(const n of t){const s=n._start,r=n._end;(!e||s<e)&&(e=s),(!o||r>o)&&(o=r)}return{minDate:e||new Date,maxDate:o||new Date}}function Uo(t){return t?t.entries?Array.from(t.entries()):Object.entries(t):[]}function tn(t,e){return t?t.get?t.get(e):t[e]:null}function Oo(t,e,o,n){var m,E,H,v;const{barHeight:s=30,padding:r=18,subtaskHeightRatio:i=.5}=e,a=s+r,g=new Map;let d=0;const b=new Map;for(const[_,u]of Uo(n))u.resource&&(b.has(u.resource)||b.set(u.resource,[]),b.get(u.resource).push(u));for(const _ of t){let u=[];const c=b.get(_.id)||[];for(const $ of c)$.parentId||$.type!=="project"&&o!=null&&o.has($.id)&&((m=$._children)==null?void 0:m.length)>0&&u.push($);if(u.length>0){let $=0;for(const U of u)$+=Ye(U,e,n);c.filter(U=>!U.parentId&&U.type!=="project"&&!(o!=null&&o.has(U.id))).length}const x=new Map,w=d+r/2,D=[...c].filter($=>!$.parentId).sort(($,U)=>$.type==="project"&&U.type!=="project"?-1:U.type==="project"&&$.type!=="project"?1:($._start||0)-(U._start||0)),Y=[],R=($,U)=>{var k,p,C;const K=$._start??((k=$.$bar)==null?void 0:k.x)??0,tt=$._end??((p=$.$bar)==null?void 0:p.x)+((C=$.$bar)==null?void 0:C.width)??K+1;for(const T of U.occupiedRanges)if(!(tt<=T.start||K>=T.end))return!0;return!1},l=($,U)=>{var p,C,T;const K=$._start??((p=$.$bar)==null?void 0:p.x)??0,tt=$._end??((C=$.$bar)==null?void 0:C.x)+((T=$.$bar)==null?void 0:T.width)??K+1;for(const F of Y)if(!R($,F))return F.occupiedRanges.push({start:K,end:tt}),F.height=Math.max(F.height,U),F.y;const k=Y.length===0?w:Y[Y.length-1].y+Y[Y.length-1].height;return Y.push({y:k,height:U,occupiedRanges:[{start:K,end:tt}]}),k};for(const $ of D){const U=(o==null?void 0:o.has($.id))&&((E=$._children)==null?void 0:E.length)>0;let K,tt;if(U){K=Ye($,e,n);const k=$.subtaskLayout||"sequential",p=k==="sequential"?s:K;tt=l($,k==="sequential"?a:K),x.set($.id,{y:tt,height:p,x:(H=$.$bar)==null?void 0:H.x,width:(v=$.$bar)==null?void 0:v.width,isExpanded:U});const T=s*i,F=r*.4;if($._children){const B=k==="mixed"||k==="parallel"?en($._children,n):null,G=(s-T)/2;$._children.forEach((j,V)=>{tn(n,j);let rt;if(k==="sequential")rt=tt+G;else{const W=(B==null?void 0:B.get(j))??V;rt=tt+G+W*(T+F)}x.set(j,{y:rt,height:T,isSubtask:!0})})}}else $.type==="project"?(K=s*.6,tt=l($,K),x.set($.id,{y:tt,height:K,isExpanded:!1})):(K=a,tt=l($,K),x.set($.id,{y:tt,height:s,isExpanded:!1}))}let h=w;for(const $ of Y)h=Math.max(h,$.y+$.height);const X=Math.max(a,h-d);g.set(_.id,{y:d,height:X,contentY:d+r/2,contentHeight:X-r,type:_.type,expandedTasks:u.map($=>$.id),taskPositions:x}),d+=X}return g.set("__total__",{height:d}),g}function Ye(t,e,o){const{barHeight:n=30,padding:s=18,subtaskHeightRatio:r=.5}=e,i=n*r,a=s*.4,g=t._children||[];if(g.length===0)return n+s;const d=t.subtaskLayout||"sequential";if(d==="sequential")return n+s;if(d==="parallel"){const b=(n-i)/2,m=g.length;return b*2+m*i+(m-1)*a}return d==="mixed"?Go(t,e,o):n+s}function en(t,e){var r,i,a;const o=new Map;if(!(t!=null&&t.length)||!e)return o;const n=t.map(g=>tn(e,g)).filter(g=>g!=null).sort((g,d)=>g.order!==void 0&&d.order!==void 0?g.order-d.order:(g._start||0)-(d._start||0)),s=[];for(const g of n){const d=g._start??((r=g.$bar)==null?void 0:r.x)??0,b=g._end??((i=g.$bar)==null?void 0:i.x)+((a=g.$bar)==null?void 0:a.width)??d+1;let m=-1;for(let E=0;E<s.length;E++)if(!s[E].some(v=>!(b<=v.start||d>=v.end))){m=E,s[E].push({start:d,end:b});break}m===-1&&(m=s.length,s.push([{start:d,end:b}])),o.set(g.id,m)}return o}function Go(t,e,o){const{barHeight:n=30,padding:s=18,subtaskHeightRatio:r=.5}=e,i=n*r,a=s*.4,g=t._children||[];if(g.length===0)return n+s;const d=en(g,o),m=Math.max(0,...d.values())+1;return(n-i)/2*2+m*i+(m-1)*a}function Xe(t,e){if(t.length===0)return-1;if(e<0)return 0;let o=0,n=t.length-1;for(;o<=n;){const s=Math.floor((o+n)/2),r=t[s];if(e>=r.y&&e<r.y+r.height)return s;e<r.y?n=s-1:o=s+1}return Math.min(o,t.length-1)}function Jo(t){const e=[];for(const[o,n]of t)o!=="__total__"&&e.push({id:o,...n});return e.sort((o,n)=>o.y-n.y),e}function Ko(t,e){const{barHeight:o=30,padding:n=18}=e,s=o+n,r=new Map;for(let i=0;i<t.length;i++){const a=t[i],g=i*s;r.set(a.id,{y:g,height:s,contentY:g+n/2,contentHeight:o,type:a.type})}return r.set("__total__",{height:t.length*s}),r}const se=(t,e)=>(t==null?void 0:t.start)===(e==null?void 0:e.start)&&(t==null?void 0:t.end)===(e==null?void 0:e.end);function Qo(t){const{scrollX:e,scrollY:o,viewportWidth:n,viewportHeight:s,columnWidth:r,rowHeight:i,totalRows:a,sortedRowLayouts:g,overscanCols:d=5,overscanRows:b=20,overscanX:m=2500}=t,E=z(()=>{const c=r(),x=e(),w=n();return c<=0||w<=0?{start:0,end:100}:{start:Math.max(0,Math.floor(x/c)-d),end:Math.ceil((x+w)/c)+d}},void 0,{equals:se}),H=z(()=>{const c=o(),x=s(),w=a();if(x<=0)return{start:0,end:Math.min(w,30)};const D=g==null?void 0:g();if(D&&D.length>0){const R=Math.max(0,Xe(D,c)-b),l=Math.min(w,Xe(D,c+x)+1+b);return{start:R,end:l}}const Y=i();return Y<=0?{start:0,end:Math.min(w,30)}:{start:Math.max(0,Math.floor(c/Y)-b),end:Math.min(w,Math.ceil((c+x)/Y)+b)}},void 0,{equals:se}),v=100,_=z(()=>{const c=e(),x=n();return{start:Math.max(0,Math.floor((c-m)/v)*v),end:Math.ceil((c+x+m)/v)*v}},void 0,{equals:se}),u=z(()=>{const c=o(),x=s(),w=(i==null?void 0:i())||48,D=b*w;return{start:Math.max(0,c-D),end:c+x+D}},void 0,{equals:se});return{colRange:E,rowRange:H,xRange:_,yRange:u}}function Zo(t){const e=new Map;for(const s of t)s._children=[],s._depth=0,e.set(s.id,s);for(const s of t)if(s.parentId){const r=e.get(s.parentId);r&&(r._children.push(s.id),r.type||(r.type="summary"))}const o=t.filter(s=>!s.parentId),n=o.map(s=>({task:s,depth:0}));for(;n.length>0;){const{task:s,depth:r}=n.shift();s._depth=r;for(const i of s._children){const a=e.get(i);a&&n.push({task:a,depth:r+1})}}for(const s of t)s.parentId&&s._depth===0&&!o.includes(s)&&(console.warn(`Circular or orphaned parent reference detected for task ${s.id}`),s._depth=0);return e}function ts(t,e){const o=new Set,n=[t],s=e.get?r=>e.get(r):r=>e[r];for(;n.length>0;){const r=n.shift(),i=s(r);for(const a of(i==null?void 0:i._children)||[])o.has(a)||(o.add(a),n.push(a))}return o}function es(t,e,o){const n=e.get?r=>e.get(r):r=>e[r];let s=n(t);for(;s!=null&&s.parentId;){if(o.has(s.parentId))return!0;s=n(s.parentId)}return!1}var ns=$t('<div style=position:absolute><div class=bar style=position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box></div><div class=bar-expected-progress style=position:absolute;top:0;left:0;height:100%></div><div class=bar-progress style=position:absolute;top:0;left:0;height:100%;opacity:0.3></div><div style=position:absolute;top:50%;white-space:nowrap;pointer-events:none;font-size:12px></div><div style=position:absolute;top:2px;right:4px;font-size:10px;pointer-events:none>ðŸ”’</div><div class="handle handle-left"style="position:absolute;left:-2px;top:25%;width:4px;height:50%;border-radius:1px;background-color:var(--g-handle-color, #ddd);cursor:ew-resize;opacity:0"></div><div class="handle handle-right"style="position:absolute;right:-2px;top:25%;width:4px;height:50%;border-radius:1px;background-color:var(--g-handle-color, #ddd);cursor:ew-resize;opacity:0"></div><div class="handle handle-progress"style="position:absolute;top:50%;transform:translateY(-50%);width:10px;height:10px;border-radius:50%;background-color:var(--g-progress-handle-color, #fff);cursor:ew-resize;opacity:0;box-sizing:border-box">');function os(t){const e=oo(),o=()=>{const f=t.task;return typeof f=="function"?f():f},n=()=>{const f=o();return(f==null?void 0:f.$bar)??{x:t.x??0,y:t.y??0,width:t.width??100,height:t.height??30}},s=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.barCornerRadius)==null?void 0:I.call(f))??t.cornerRadius??3}),r=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.readonly)==null?void 0:I.call(f))??t.readonly??!1}),i=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.readonlyDates)==null?void 0:I.call(f))??t.readonlyDates??!1}),a=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.readonlyProgress)==null?void 0:I.call(f))??t.readonlyProgress??!1}),g=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.showExpectedProgress)==null?void 0:I.call(f))??t.showExpectedProgress??!1}),d=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.columnWidth)==null?void 0:I.call(f))??t.columnWidth??45}),b=z(()=>{var f,I;return((I=(f=t.ganttConfig)==null?void 0:f.ignoredPositions)==null?void 0:I.call(f))??t.ignoredPositions??[]}),m=z(()=>{var I,S;const f=o();return f?{id:f.id??"",name:f.name??"",color:f.color??"#b8c2cc",colorProgress:f.color_progress??"#a3a3ff",progress:f.progress??0,locked:((I=f.constraints)==null?void 0:I.locked)??!1,invalid:f.invalid??!1,customClass:f.custom_class??"",hasChildren:(((S=f._children)==null?void 0:S.length)??0)>0,start:f._start??f.start??null,end:f._end??f.end??null}:{id:"",name:"",color:"#b8c2cc",colorProgress:"#a3a3ff",progress:0,locked:!1,invalid:!1,customClass:"",hasChildren:!1,start:null,end:null}}),E=z(()=>n()),H=()=>{var f;return((f=E())==null?void 0:f.x)??0},v=()=>{var I;const f=typeof t.taskPosition=="function"?t.taskPosition():t.taskPosition;return(f==null?void 0:f.y)??((I=E())==null?void 0:I.y)??0},_=()=>{var f;return((f=E())==null?void 0:f.width)??100},u=()=>{var f;return((f=E())==null?void 0:f.height)??30},c=()=>d();let x=!1;const{dragState:w,isDragging:D,startDrag:Y}=Ue({onDragStart:(f,I)=>{var S,et,st;if(x=!1,f.originalX=H(),f.originalY=v(),f.originalWidth=_(),f.originalProgress=m().progress,(et=(S=t.taskStore)==null?void 0:S.setDraggingTaskId)==null||et.call(S,m().id),I==="dragging_bar"){const dt=new Set;if(t.onCollectDependents){const nt=t.onCollectDependents(m().id);for(const at of nt)dt.add(at)}if(t.onCollectDescendants){const nt=t.onCollectDescendants(m().id);for(const at of nt)dt.add(at)}f.dependentOriginals=new Map;for(const nt of dt){const at=(st=t.taskStore)==null?void 0:st.getBarPosition(nt);at&&f.dependentOriginals.set(nt,{originalX:at.x})}}},onDragMove:(f,I,S)=>{var dt;if(!t.taskStore||!m().id)return;x=!0;const et=d(),st=b();if(S==="dragging_bar"){let nt=ke(I.originalX+f.deltaX,et,st),at=nt-I.originalX;if(((dt=I.dependentOriginals)==null?void 0:dt.size)>0&&t.taskStore.batchMovePositions)t.onClampBatchDelta&&at<0&&(at=t.onClampBatchDelta(I.dependentOriginals,at)),t.taskStore.batchMovePositions(I.dependentOriginals,at);else{if(t.onConstrainPosition){const A=t.onConstrainPosition(m().id,nt,v());if(A===null)return;nt=A.x??nt}t.taskStore.updateBarPosition(m().id,{x:nt})}}else if(S==="dragging_left"){const nt=f.deltaX,at=Math.round(nt/et)*et;let A=I.originalX+at,P=I.originalWidth-at;if(P<c()&&(P=c(),A=I.originalX+I.originalWidth-c()),A=ke(A,et,st),t.onConstrainPosition){const Ct=t.onConstrainPosition(m().id,A,v());if(Ct===null)return;Ct.x>A&&(P=P-(Ct.x-A),A=Ct.x)}t.taskStore.updateBarPosition(m().id,{x:A,width:P})}else if(S==="dragging_right"){const nt=f.deltaX,at=Math.round(nt/et)*et;let A=I.originalWidth+at;A=Math.max(c(),A),t.taskStore.updateBarPosition(m().id,{width:A})}else if(S==="dragging_progress"){const nt=H(),at=_(),A=b(),P=d();let Ct=Be(I.startSvgX+f.deltaX,nt,nt+at);const Q=A.reduce((q,O)=>q+(O>=nt&&O<nt+at?1:0),0),ht=at-Q*P,bt=Ct-nt,ct=A.reduce((q,O)=>q+(O>=nt&&O<Ct?1:0),0),yt=bt-ct*P,y=ht>0?Be(Math.round(yt/ht*100),0,100):0;if(t.taskStore){const q=t.taskStore.getTask(m().id);q&&t.taskStore.updateTask(m().id,{...q,progress:y})}}},onDragEnd:(f,I,S)=>{var nt,at,A;(at=(nt=t.taskStore)==null?void 0:nt.setDraggingTaskId)==null||at.call(nt,null);const et=t.onDateChange??e.onDateChange,st=t.onResizeEnd??e.onResizeEnd,dt=t.onProgressChange??e.onProgressChange;if(S==="dragging_bar"||S==="dragging_left"||S==="dragging_right"){const P=(A=t.taskStore)==null?void 0:A.getBarPosition(m().id);et==null||et(m().id,{x:(P==null?void 0:P.x)??H(),width:(P==null?void 0:P.width)??_()}),(S==="dragging_left"||S==="dragging_right")&&(st==null||st(m().id))}else S==="dragging_progress"&&(dt==null||dt(m().id,m().progress))}}),R=f=>{if(r()||i()||J())return;const I=f.target;I.classList&&I.classList.contains("handle")||(x=!1,Y(f,"dragging_bar",{taskId:m().id}))},l=f=>{const I=t.onHover??e.onHover;I&&!D()&&I(m().id,f.clientX,f.clientY)},h=()=>{const f=t.onHoverEnd??e.onHoverEnd;f&&f()},X=f=>{const I=t.onTaskClick??e.onTaskClick;!x&&I&&(f.stopPropagation(),I(m().id,f))},$=f=>{r()||i()||J()||(f.stopPropagation(),Y(f,"dragging_left",{taskId:m().id}))},U=f=>{r()||i()||J()||(f.stopPropagation(),Y(f,"dragging_right",{taskId:m().id}))},K=f=>{r()||a()||J()||(f.stopPropagation(),Y(f,"dragging_progress",{taskId:m().id}))},tt=z(()=>ze(H(),_(),m().progress,b(),d())),k=z(()=>{var et,st,dt,nt;if(!g())return 0;const f=m().start,I=m().end;if(!f||!I)return 0;const S=Ho(f,I,((st=(et=t.ganttConfig)==null?void 0:et.unit)==null?void 0:st.call(et))??"day",((nt=(dt=t.ganttConfig)==null?void 0:dt.step)==null?void 0:nt.call(dt))??1);return ze(H(),_(),S,b(),d())}),p=z(()=>Ze(H(),_(),m().name)),C=()=>m().color,T=()=>m().colorProgress,F=()=>"var(--g-expected-progress-color, rgba(0,0,0,0.2))",B=()=>m().hasChildren,G=()=>m().invalid,j=()=>m().customClass,V=()=>!r(),rt=()=>V()&&!i(),W=()=>V()&&!a(),J=()=>m().locked,ut=()=>D()?`dragging ${w()}`:"",gt=()=>J()?"#7f8c8d":D()?"#2c3e50":C(),kt=()=>J()||D()?1:B()?0:.1;Dt(()=>{const f=m().id,I=gt(),S=kt();f==="task-0"&&console.log("[Bar task-0]",{bg:I,op:S,locked:J(),dragging:D(),hasSubtasks:B()})});const pt=()=>t.visible??!0,Mt=()=>`translate(${H()}px, ${v()}px)`;return(()=>{var f=ns(),I=f.firstChild,S=I.nextSibling,et=S.nextSibling,st=et.nextSibling,dt=st.nextSibling,nt=dt.nextSibling,at=nt.nextSibling,A=at.nextSibling;return f.$$click=X,f.addEventListener("mouseleave",h),f.addEventListener("mouseenter",l),f.$$mousedown=R,it(st,()=>m().name),nt.$$mousedown=$,at.$$mousedown=U,A.$$mousedown=K,wt(P=>{var Ct=`bar-wrapper ${j()} ${G()?"invalid":""} ${J()?"locked":""} ${ut()}`,Q=m().id,ht=Mt(),bt=`${_()}px`,ct=`${u()}px`,yt=J()?"not-allowed":r()?"default":"move",y=pt()?"visible":"hidden",q=`${s()}px`,O=J()?"#7f8c8d":D()?"#2c3e50":C(),ft=J()||D()?1:B()?0:.1,xt=`${J()?"2px":"1.5px"} solid ${J()?"#c0392b":C()}`,mt=J()?"dashed":"solid",Ht=D()?"none":"background-color 0.1s ease",Pt=`${k()}px`,Rt=`${s()}px`,Et=F(),St=g()&&k()>0?"block":"none",It=`${tt()}px`,qt=`${s()}px`,At=T(),Kt=`bar-label ${p().position}`,Lt=p().position==="inside"?"50%":`${_()+5}px`,Vt=p().position==="inside"?"translate(-50%, -50%)":"translateY(-50%)",Bt=p().position==="inside"?"#fff":"#333",Qt=J()?"block":"none",Wt=V()&&!J()&&rt()?"block":"none",jt=V()&&!J()&&rt()?"block":"none",Nt=`${tt()-5}px`,Ut=`2px solid ${T()}`,Ot=V()&&!J()&&W()&&tt()>0?"block":"none";return Ct!==P.e&&ye(f,P.e=Ct),Q!==P.t&&lt(f,"data-id",P.t=Q),ht!==P.a&&N(f,"transform",P.a=ht),bt!==P.o&&N(f,"width",P.o=bt),ct!==P.i&&N(f,"height",P.i=ct),yt!==P.n&&N(f,"cursor",P.n=yt),y!==P.s&&N(f,"visibility",P.s=y),q!==P.h&&N(I,"border-radius",P.h=q),O!==P.r&&N(I,"background-color",P.r=O),ft!==P.d&&N(I,"opacity",P.d=ft),xt!==P.l&&N(I,"border",P.l=xt),mt!==P.u&&N(I,"border-style",P.u=mt),Ht!==P.c&&N(I,"transition",P.c=Ht),Pt!==P.w&&N(S,"width",P.w=Pt),Rt!==P.m&&N(S,"border-radius",P.m=Rt),Et!==P.f&&N(S,"background-color",P.f=Et),St!==P.y&&N(S,"display",P.y=St),It!==P.g&&N(et,"width",P.g=It),qt!==P.p&&N(et,"border-radius",P.p=qt),At!==P.b&&N(et,"background-color",P.b=At),Kt!==P.T&&ye(st,P.T=Kt),Lt!==P.A&&N(st,"left",P.A=Lt),Vt!==P.O&&N(st,"transform",P.O=Vt),Bt!==P.I&&N(st,"color",P.I=Bt),Qt!==P.S&&N(dt,"display",P.S=Qt),Wt!==P.W&&N(nt,"display",P.W=Wt),jt!==P.C&&N(at,"display",P.C=jt),Nt!==P.B&&N(A,"left",P.B=Nt),Ut!==P.v&&N(A,"border",P.v=Ut),Ot!==P.k&&N(A,"display",P.k=Ot),P},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),f})()}ae(["mousedown","click"]);var ss=$t("<div data-type=summary style=position:absolute;will-change:transform;pointer-events:auto><div class=bar style=position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box></div><div class=bar-progress style=position:absolute;top:0;left:0;height:100%;pointer-events:none></div><div class=bar-label style=position:absolute;top:50%;font-size:12px;font-weight:500;pointer-events:none;user-select:none;white-space:nowrap></div><div style=position:absolute;top:50%;transform:translateY(-50%);font-size:10px;color:#888;pointer-events:none;white-space:nowrap>(<!>)");function rs(t){const e=()=>{const l=t.taskId;return typeof l=="function"?l():l},o=()=>{const l=e();if(t.taskStore&&l){const h=t.taskStore.tasks[l];if(h!=null&&h.$bar)return h.$bar}return{x:0,y:0,width:100,height:30}},n=()=>{const l=e();return t.taskStore&&l?t.taskStore.tasks[l]??{}:{}},s=z(()=>o()),r=()=>{var l;return((l=s())==null?void 0:l.x)??0},i=()=>{var h;const l=typeof t.taskPosition=="function"?t.taskPosition():t.taskPosition;return(l==null?void 0:l.y)??((h=s())==null?void 0:h.y)??0},a=()=>{var l;return((l=s())==null?void 0:l.width)??100},g=()=>{var l;return((l=s())==null?void 0:l.height)??30},d=z(()=>{var l,h;return((h=(l=t.ganttConfig)==null?void 0:l.columnWidth)==null?void 0:h.call(l))??45}),b=z(()=>{var l,h;return((h=(l=t.ganttConfig)==null?void 0:l.readonly)==null?void 0:h.call(l))??!1}),m=z(()=>{var l,h;return((h=(l=t.ganttConfig)==null?void 0:l.barCornerRadius)==null?void 0:h.call(l))??3}),E=()=>{var l;return((l=n())==null?void 0:l.color)??"var(--g-bar-color, #b8c2cc)"},H=()=>{var l;return((l=n())==null?void 0:l.color_progress)??"var(--g-bar-progress-color, #a3a3ff)"},v=()=>{var l;return((l=n())==null?void 0:l.progress)??0},_=()=>a()*v()/100,u=z(()=>{var h;const l=((h=n())==null?void 0:h.name)??"";return Ze(r(),a(),l,7)}),{dragState:c,isDragging:x,startDrag:w}=Ue({onDragStart:(l,h)=>{var X;if(l.originalX=r(),l.originalY=i(),h==="dragging_bar"&&t.onCollectDescendants){const $=t.onCollectDescendants(e());$.add(e()),l.batchOriginals=new Map;for(const U of $){const K=(X=t.taskStore)==null?void 0:X.getBarPosition(U);K&&l.batchOriginals.set(U,{originalX:K.x})}}},onDragMove:(l,h,X)=>{var tt;if(!t.taskStore||!e()||X!=="dragging_bar")return;const $=d();let K=ke(h.originalX+l.deltaX,$,[])-h.originalX;((tt=h.batchOriginals)==null?void 0:tt.size)>0&&t.taskStore.batchMovePositions&&(t.onClampBatchDelta&&K<0&&(K=t.onClampBatchDelta(h.batchOriginals,K)),t.taskStore.batchMovePositions(h.batchOriginals,K))},onDragEnd:(l,h)=>{var X;h==="dragging_bar"&&((X=t.onDragEnd)==null||X.call(t,e()))}}),D=()=>{const l=c();return l==="idle"?"":`dragging ${l}`},Y=l=>{b()||(l.preventDefault(),l.stopPropagation(),w(l,"dragging_bar"))},R=()=>`translate(${r()}px, ${i()}px)`;return(()=>{var l=ss(),h=l.firstChild,X=h.nextSibling,$=X.nextSibling,U=$.nextSibling,K=U.firstChild,tt=K.nextSibling;return tt.nextSibling,l.$$mousedown=Y,it($,()=>{var k;return((k=n())==null?void 0:k.name)??""}),it(U,()=>{var k,p;return((p=(k=n())==null?void 0:k._children)==null?void 0:p.length)??0},tt),wt(k=>{var S,et,st,dt;var p=`summary-bar-wrapper bar-wrapper ${D()}`,C=e(),T=R(),F=`${a()}px`,B=`${g()}px`,G=b()?"default":"grab",j=`${m()}px`,V=x()?"#2c3e50":E(),rt=x()?"none":"background-color 0.1s ease",W=`${_()}px`,J=`${m()}px`,ut=H(),gt=v()>0?"block":"none",kt=u().position==="inside"?"50%":`${a()+8}px`,pt=u().position==="inside"?"translate(-50%, -50%)":"translateY(-50%)",Mt=u().position==="inside"?"#fff":"#333",f=`${a()+8+(((et=(S=n())==null?void 0:S.name)==null?void 0:et.length)??0)*7}px`,I=((dt=(st=n())==null?void 0:st._children)==null?void 0:dt.length)>0?"block":"none";return p!==k.e&&ye(l,k.e=p),C!==k.t&&lt(l,"data-id",k.t=C),T!==k.a&&N(l,"transform",k.a=T),F!==k.o&&N(l,"width",k.o=F),B!==k.i&&N(l,"height",k.i=B),G!==k.n&&N(l,"cursor",k.n=G),j!==k.s&&N(h,"border-radius",k.s=j),V!==k.h&&N(h,"background-color",k.h=V),rt!==k.r&&N(h,"transition",k.r=rt),W!==k.d&&N(X,"width",k.d=W),J!==k.l&&N(X,"border-radius",k.l=J),ut!==k.u&&N(X,"background-color",k.u=ut),gt!==k.c&&N(X,"display",k.c=gt),kt!==k.w&&N($,"left",k.w=kt),pt!==k.m&&N($,"transform",k.m=pt),Mt!==k.f&&N($,"color",k.f=Mt),f!==k.y&&N(U,"left",k.y=f),I!==k.g&&N(U,"display",k.g=I),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),l})()}ae(["mousedown"]);var as=$t("<svg><rect class=subtask-bar-progress fill-opacity=0.3 style=pointer-events:none></svg>",!1,!0,!1),is=$t("<svg><g class=subtask-bar><rect class=subtask-bar-bg fill-opacity=0.1 stroke-width=1.5></rect><text class=subtask-label font-size=10 fill=#333 text-anchor=middle dominant-baseline=middle style=pointer-events:none;user-select:none></svg>",!1,!0,!1);function ls(t){const e=()=>t.task,o=()=>{var u;return((u=e())==null?void 0:u.$bar)||{x:0,width:100}},n=()=>o().x,s=()=>o().width,r=()=>t.y??0,i=()=>t.config||{},a=()=>i().barHeight??30,g=()=>i().subtaskHeightRatio??.5,d=()=>(i().cornerRadius??3)*.7,b=()=>a()*g(),m=()=>{var u;return((u=e())==null?void 0:u.color)??i().parentColor??"var(--g-bar-color, #b8c2cc)"},E=()=>{var u;return((u=e())==null?void 0:u.color_progress)??m()},H=()=>{var u;return((u=e())==null?void 0:u.progress)??0},v=()=>{const u=s(),c=H();return Math.max(0,u*c/100)},_=()=>n()+s()/2;return(()=>{var u=is(),c=u.firstChild,x=c.nextSibling;return it(u,vt(Ce,{get when(){return H()>0},get children(){var w=as();return wt(D=>{var Y=n(),R=r(),l=v(),h=b(),X=d(),$=d(),U=E();return Y!==D.e&&lt(w,"x",D.e=Y),R!==D.t&&lt(w,"y",D.t=R),l!==D.a&&lt(w,"width",D.a=l),h!==D.o&&lt(w,"height",D.o=h),X!==D.i&&lt(w,"rx",D.i=X),$!==D.n&&lt(w,"ry",D.n=$),U!==D.s&&lt(w,"fill",D.s=U),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w}}),x),it(x,()=>{var w;return((w=e())==null?void 0:w.name)??""}),wt(w=>{var C;var D=(C=e())==null?void 0:C.id,Y=t.index,R=n(),l=r(),h=s(),X=b(),$=d(),U=d(),K=m(),tt=m(),k=_(),p=r()+b()/2;return D!==w.e&&lt(u,"data-id",w.e=D),Y!==w.t&&lt(u,"data-index",w.t=Y),R!==w.a&&lt(c,"x",w.a=R),l!==w.o&&lt(c,"y",w.o=l),h!==w.i&&lt(c,"width",w.i=h),X!==w.n&&lt(c,"height",w.n=X),$!==w.s&&lt(c,"rx",w.s=$),U!==w.h&&lt(c,"ry",w.h=U),K!==w.r&&lt(c,"fill",w.r=K),tt!==w.d&&lt(c,"stroke",w.d=tt),k!==w.l&&lt(x,"x",w.l=k),p!==w.u&&lt(x,"y",w.u=p),w},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),u})()}var cs=$t("<svg><g class=expanded-task-container><rect class=parent-container fill=none stroke-width=2 stroke-opacity=0.6 stroke-dasharray=6,3></rect><g class=subtasks></svg>",!1,!0,!1);function ds(t){const e=()=>{var v;return(v=t.taskStore)==null?void 0:v.tasks[t.taskId]},o=()=>{var u,c;const v=e();if(!((u=v==null?void 0:v._children)!=null&&u.length))return[];const _=(c=t.taskStore)==null?void 0:c.tasks;return _?v._children.map(x=>_[x]).filter(x=>x!=null):[]},n=()=>{var v;return((v=e())==null?void 0:v.subtaskLayout)||"sequential"},s=()=>{var v,_;return((_=(v=t.ganttConfig)==null?void 0:v.barHeight)==null?void 0:_.call(v))??30},r=()=>{var v,_;return((_=(v=t.ganttConfig)==null?void 0:v.padding)==null?void 0:_.call(v))??18},i=()=>{var v,_;return((_=(v=t.ganttConfig)==null?void 0:v.subtaskHeightRatio)==null?void 0:_.call(v))??.5},a=()=>{var v,_;return((_=(v=t.ganttConfig)==null?void 0:v.barCornerRadius)==null?void 0:_.call(v))??3},g=()=>{var v;return((v=e())==null?void 0:v.$bar)||{x:0,y:0,width:100,height:30}},d=()=>{var u;const v=t.rowLayout,_=(u=v==null?void 0:v.taskPositions)==null?void 0:u.get(t.taskId);return(_==null?void 0:_.y)!==void 0?_.y:v?v.y:g().y-r()/2},b=()=>{var D;const v=t.rowLayout,_=(D=v==null?void 0:v.taskPositions)==null?void 0:D.get(t.taskId);if((_==null?void 0:_.height)!==void 0)return _.height;if(n()==="sequential")return s();const u=s()*i(),c=r()*.4,x=o().length;return(s()-u)/2*2+x*u+(x-1)*c},m=()=>{var v;return((v=e())==null?void 0:v.color)??"var(--g-bar-color, #b8c2cc)"},E=()=>({barHeight:s(),padding:r(),subtaskHeightRatio:i(),cornerRadius:a(),parentColor:m()}),H=(v,_)=>{var Y;const u=t.rowLayout,c=(Y=u==null?void 0:u.taskPositions)==null?void 0:Y.get(_==null?void 0:_.id);if((c==null?void 0:c.y)!==void 0)return c.y;const x=s()*i(),w=r()*.4,D=(s()-x)/2;return n()==="sequential"?d()+D:d()+D+v*(x+w)};return(()=>{var v=cs(),_=v.firstChild,u=_.nextSibling;return it(u,vt(Oe,{get each(){return o()},children:(c,x)=>vt(ls,{task:c,get index(){return x()},get y(){return H(x(),c)},get layout(){return n()},get config(){return E()},get ganttConfig(){return t.ganttConfig}})})),wt(c=>{var x=t.taskId,w=n(),D=g().x,Y=d(),R=g().width,l=b(),h=m(),X=a(),$=a();return x!==c.e&&lt(v,"data-id",c.e=x),w!==c.t&&lt(v,"data-layout",c.t=w),D!==c.a&&lt(_,"x",c.a=D),Y!==c.o&&lt(_,"y",c.o=Y),R!==c.i&&lt(_,"width",c.i=R),l!==c.n&&lt(_,"height",c.n=l),h!==c.s&&lt(_,"stroke",c.s=h),X!==c.h&&lt(_,"rx",c.h=X),$!==c.r&&lt(_,"ry",c.r=$),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),v})()}var us=$t('<div class=task-layer style="contain:layout style;position:relative;width:100%;height:100%"><div class=summary-layer style="contain:layout style"></div><div class=expanded-layer style="contain:layout style"></div><div class=task-bars-layer style="contain:layout style">'),gs=$t("<div>"),fs=$t("<div style=pointer-events:auto>");const qe=5;function hs(t){const e=()=>t.relationships||[],o=(p,C,T)=>{var G,j;if(!t.taskStore)return{x:C,y:T};const F=((j=(G=t.ganttConfig)==null?void 0:G.columnWidth)==null?void 0:j.call(G))??45,B=Te(p,C,T,t.taskStore,e(),{pixelsPerTimeUnit:F});if(!B)return null;if(B.type==="batch"){for(const rt of B.updates)rt.taskId!==p&&t.taskStore.updateBarPosition(rt.taskId,{x:rt.x});const V=B.updates.find(rt=>rt.taskId===p);return V?{x:V.x,y:V.y}:{x:C,y:T}}return{x:B.x,y:B.y}},n=(p,C)=>{var T;(T=t.onDateChange)==null||T.call(t,p,C)},s=(p,C)=>{var T;(T=t.onProgressChange)==null||T.call(t,p,C)},r=p=>{var C;t.taskStore&&Yo(p,t.taskStore,e()),(C=t.onResizeEnd)==null||C.call(t,p)},i=(p,C,T)=>{var F;(F=t.onHover)==null||F.call(t,p,C,T)},a=()=>{var p;(p=t.onHoverEnd)==null||p.call(t)},g=(p,C)=>{var T;(T=t.onTaskClick)==null||T.call(t,p,C)},d=p=>{var T,F;const C=(F=(T=t.taskStore)==null?void 0:T.getTask)==null?void 0:F.bind(t.taskStore);return zo(p,e(),C)},b=(p,C)=>{var B,G,j,V;const T=(G=(B=t.taskStore)==null?void 0:B.getTask)==null?void 0:G.bind(t.taskStore),F=((V=(j=t.ganttConfig)==null?void 0:j.columnWidth)==null?void 0:V.call(j))??45;return Wo(p,C,e(),T,{pixelsPerTimeUnit:F})},m=p=>{if(!t.taskStore)return new Set;const C=t.taskStore.tasks;return ts(p,C)},E=p=>{var C;(C=t.taskStore)==null||C.toggleTaskCollapse(p)},H=()=>{var p;return((p=t.resourceStore)==null?void 0:p.displayResources())||[]},v=()=>t.startRow??0,_=()=>t.endRow??H().length,u=()=>t.startX??0,c=()=>t.endX??1/0;let x=null,w=-1;const D=()=>{var F;const p=(F=t.taskStore)==null?void 0:F.tasks;if(!p)return new Map;const C=Ft(()=>Object.keys(p));if(C.length===w&&x)return x;w=C.length;const T=new Map;return Ft(()=>{for(const B of C){const G=p[B];if(!G||G._isHidden)continue;const j=G.resource||"Unassigned";T.has(j)||T.set(j,[]),T.get(j).push(G)}}),x=T,T},Y=z(()=>{const p=[],C=H(),T=D(),F=v(),B=_(),G=u(),j=c();for(let V=F;V<B&&V<C.length;V++){const rt=C[V];if(rt.type==="group")continue;const W=T.get(rt.id);W&&Ft(()=>{if(j===1/0)for(let J=0;J<W.length;J++)p.push(W[J].id);else for(let J=0;J<W.length;J++){const ut=W[J],gt=ut.$bar;(!gt||gt.x+gt.width>=G-200&&gt.x<=j+200)&&p.push(ut.id)}})}return p}),R=p=>{var C,T;return((T=(C=t.ganttConfig)==null?void 0:C.isTaskExpanded)==null?void 0:T.call(C,p))??!1},l=()=>{var p,C;return((C=(p=t.ganttConfig)==null?void 0:p.renderMode)==null?void 0:C.call(p))==="simple"},h=z(()=>{const p=l(),C=Y();return Ft(()=>{var rt;const T=[],F=[],B=[],G=((rt=t.taskStore)==null?void 0:rt.tasks)??{},j=new Map,V=W=>(j.has(W)||j.set(W,R(W)),j.get(W));for(const W of C){const J=G[W];if(!J)continue;const ut=J.parentId,gt=J.type,kt=J._children;if(p){if(ut)continue;gt==="summary"||gt==="project"?F.push(W):T.push(W);continue}const pt=kt&&kt.length>0,Mt=V(W);pt&&Mt?B.push(W):gt==="summary"||gt==="project"?F.push(W):(!ut||!V(ut))&&T.push(W)}return{regularIds:T,summaryIds:F,expandedIds:B}})});let X=0,$=0;const U=z(()=>{const p=h().regularIds;X=Math.max(X,p.length);const C=X+qe,T=new Array(C);for(let F=0;F<p.length;F++)T[F]=p[F];return T}),K=z(()=>{var T;const p=U(),C=((T=t.taskStore)==null?void 0:T.tasks)??{};return Ft(()=>p.map(F=>F?C[F]:void 0))}),tt=z(()=>{const p=h().summaryIds;$=Math.max($,p.length);const C=$+qe,T=new Array(C);for(let F=0;F<p.length;F++)T[F]=p[F];return T}),k=p=>{var G,j,V;const C=t.rowLayouts;if(!C)return null;const T=(j=(G=t.taskStore)==null?void 0:G.getTask)==null?void 0:j.call(G,p);if(!T)return null;const F=C.get(T.resource);if(!F)return null;if(l())return{...F,y:F.contentY,height:F.contentHeight,isExpanded:!1};const B=(V=F.taskPositions)==null?void 0:V.get(p);return B?{...F,y:B.y,height:B.height,isExpanded:B.isExpanded}:F};return(()=>{var p=us(),C=p.firstChild,T=C.nextSibling,F=T.nextSibling;return it(C,vt(be,{get each(){return tt()},children:B=>(()=>{var G=gs();return it(G,vt(rs,{taskId:B,get taskStore(){return t.taskStore},get ganttConfig(){return t.ganttConfig},onCollectDescendants:m,onClampBatchDelta:b,onToggleCollapse:E,onDragEnd:r})),wt(j=>N(G,"display",B()?"block":"none")),G})()})),it(T,vt(Oe,{get each(){return h().expandedIds},children:B=>vt(ds,{taskId:B,get taskStore(){return t.taskStore},get ganttConfig(){return t.ganttConfig},get rowLayout(){return k(B)}})})),it(F,vt(be,{get each(){return K()},children:B=>(()=>{var G=fs();return it(G,vt(os,{task:B,get taskStore(){return t.taskStore},get ganttConfig(){return t.ganttConfig},onConstrainPosition:o,onCollectDependents:d,onCollectDescendants:m,onClampBatchDelta:b,onDateChange:n,onProgressChange:s,onResizeEnd:r,onHover:i,onHoverEnd:a,onTaskClick:g})),wt(j=>N(G,"display",B()?"block":"none")),G})()})),p})()}var ms=$t("<div style=position:absolute><div style=position:absolute;top:0;left:0;width:100%;height:100%;opacity:0.15;border-radius:3px></div><div style=position:absolute;top:0;left:0;height:100%;background-color:#a3a3ff;opacity:0.3;border-radius:3px></div><div style=position:absolute;top:50%;left:8px;transform:translateY(-50%);color:#fff;font-size:12px;white-space:nowrap></div><div style=position:absolute;bottom:2px;right:4px;font-size:9px;color:#888>");function vs(t){const e=()=>typeof t.task=="function"?t.task():t.task,o=z(()=>{var i,a,g,d;const n=e(),s=(n==null?void 0:n.progress)??0,r=((i=n==null?void 0:n.$bar)==null?void 0:i.width)??100;return{color:(n==null?void 0:n.color)??"#3b82f6",progress:s,name:(n==null?void 0:n.name)??"",pw:r*s/100,id:(n==null?void 0:n.id)??"",x:((a=n==null?void 0:n.$bar)==null?void 0:a.x)??0,y:((g=n==null?void 0:n.$bar)==null?void 0:g.y)??0,width:r,height:((d=n==null?void 0:n.$bar)==null?void 0:d.height)??30}});return(()=>{var n=ms(),s=n.firstChild,r=s.nextSibling,i=r.nextSibling,a=i.nextSibling;return it(i,()=>o().name),it(a,()=>o().id),wt(g=>{var d=`translate(${o().x}px, ${o().y}px)`,b=`${o().width}px`,m=`${o().height}px`,E=o().color,H=`${o().pw}px`;return d!==g.e&&N(n,"transform",g.e=d),b!==g.t&&N(n,"width",g.t=b),m!==g.a&&N(n,"height",g.a=m),E!==g.o&&N(s,"background-color",g.o=E),H!==g.i&&N(r,"width",g.i=H),g},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),n})()}var xs=$t('<div class=task-layer-minimal style="contain:layout style;position:relative;width:100%;height:100%">');function ys(t){const e=()=>{var b;return((b=t.resourceStore)==null?void 0:b.displayResources())||[]},o=()=>t.startRow??0,n=()=>t.endRow??50,s=()=>t.startX??0,r=()=>t.endX??1/0;let i=null,a=-1;const g=()=>{var H;const b=(H=t.taskStore)==null?void 0:H.tasks;if(!b)return new Map;const m=Ft(()=>Object.keys(b));if(m.length===a&&i)return i;a=m.length;const E=new Map;return Ft(()=>{for(const v of m){const _=b[v];if(!_||_._isHidden)continue;const u=_.resource||"Unassigned";E.has(u)||E.set(u,[]),E.get(u).push(_)}}),i=E,E},d=z(()=>{const b=[],m=e(),E=g(),H=o(),v=n(),_=s(),u=r();for(let c=H;c<v&&c<m.length;c++){const x=m[c];if(x.type==="group")continue;const w=E.get(x.id);w&&Ft(()=>{if(u===1/0)for(let D=0;D<w.length;D++)b.push(w[D]);else for(let D=0;D<w.length;D++){const Y=w[D],R=Y.$bar;(!R||R.x+R.width>=_-200&&R.x<=u+200)&&b.push(Y)}})}return b});return(()=>{var b=xs();return it(b,vt(be,{get each(){return d()},children:m=>vt(vs,{task:m})})),b})()}function bs(t,e){var n;if(!t)return"";const o=[`Task: "${t.name||"Unnamed"}"`,`ID: ${t.id}`,`Progress: ${t.progress??0}%`];return e&&(o.push(`Position: (${Math.round(e.x)}, ${Math.round(e.y)})`),o.push(`Size: ${Math.round(e.width)} x ${Math.round(e.height)}`)),(n=t.constraints)!=null&&n.locked&&o.push("Status: Locked"),t.invalid&&o.push("Status: Invalid"),o.join(`
`)}function ps(t,e,o=[]){if(!t)return null;const n={...t};return delete n.$bar,{sections:{rawTask:JSON.stringify(n,null,2),position:e?JSON.stringify({x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height),index:e.index},null,2):"N/A",relationships:ks(t.id,o)},raw:JSON.stringify({task:n,position:e},null,2)}}const ws={FS:"Finish-to-Start",SS:"Start-to-Start",FF:"Finish-to-Finish",SF:"Start-to-Finish"};function Ve(t,e,o){const n=ws[t.type]||t.type,s=t.lag??0,r=s?`, lag: ${s} day${s!==1?"s":""}`:"";return`  ${t.type} ${o} ${e} (${n}${r})`}function ks(t,e){if(!e||e.length===0)return"No relationships defined";const o=e.filter(r=>r.to===t),n=e.filter(r=>r.from===t);let s="";return o.length===0?s+=`Incoming: (none)
`:(s+=`Incoming:
`,o.forEach(r=>{s+=Ve(r,r.from,"<-")+`
`})),n.length===0?s+="Outgoing: (none)":(s+=`Outgoing:
`,n.forEach((r,i)=>{s+=Ve(r,r.to,"->"),i<n.length-1&&(s+=`
`)})),s}function je(t){return t?t.replace(/"([^"]+)":/g,'<span style="color: #9b59b6;">"$1"</span>:').replace(/: "([^"]+)"/g,': <span style="color: #27ae60;">"$1"</span>').replace(/: (-?\d+\.?\d*)/g,': <span style="color: #e74c3c;">$1</span>').replace(/: (true|false)/g,': <span style="color: #3498db;">$1</span>').replace(/: (null)/g,': <span style="color: #95a5a6;">$1</span>'):""}var Ss=$t('<div><div style=font-family:monospace;white-space:pre-line;line-height:1.5></div><div style="margin-top:10px;padding-top:8px;border-top:1px solid #eee;font-size:10px;color:#999;text-align:center;font-family:sans-serif">Click for full data');function Cs(t){const e=z(()=>{var r,i;const n=(r=t.task)==null?void 0:r.call(t),s=(i=t.barPosition)==null?void 0:i.call(t);return n?bs(n,s):""}),o=z(()=>{var s;const n=((s=t.position)==null?void 0:s.call(t))||{x:0,y:0};return{position:"fixed",left:`${n.x+15}px`,top:`${n.y-10}px`,background:"#fff","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","border-radius":"6px",padding:"12px","min-width":"180px","max-width":"280px","z-index":1100,"font-size":"12px","border-left":"3px solid #3498db","pointer-events":"none"}});return vt(Ce,{get when(){var n;return(n=t.visible)==null?void 0:n.call(t)},get children(){var n=Ss(),s=n.firstChild;return s.nextSibling,it(s,e),wt(r=>ot(n,o(),r)),n}})}var Ts=$t('<div tabindex=-1 style=position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:2000><div style="background:#fff;border-radius:8px;width:90%;max-width:600px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 10px 40px rgba(0,0,0,0.3)"><div style="display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #eee;flex-shrink:0"><h3 style=margin:0;font-size:16px;font-weight:600>Task Data: </h3><button title="Close (Esc)"style="border:none;background:none;font-size:24px;cursor:pointer;padding:4px 8px;color:#666;line-height:1">&times;</button></div><div style=padding:20px;overflow:auto;flex:1><div style=margin-bottom:20px><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:8px><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px>Raw Task Object</span><button style="padding:4px 10px;border:none;border-radius:3px;cursor:pointer;font-size:11px;transition:background 0.2s"></button></div><pre style=background:#f8f9fa;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;white-space:pre-wrap;word-break:break-all;overflow:auto;max-height:200px;margin:0;line-height:1.5></pre></div><div style=margin-bottom:20px><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px;display:block;margin-bottom:8px>Computed Position ($bar)</span><pre style=background:#f8f9fa;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;margin:0;line-height:1.5></pre></div><div><span style=font-size:11px;font-weight:600;text-transform:uppercase;color:#999;letter-spacing:0.5px;display:block;margin-bottom:8px>Relationships</span><pre style=background:#fff8e1;border-radius:4px;padding:12px;font-family:monospace;font-size:12px;white-space:pre-wrap;margin:0;line-height:1.5;color:#5d4037>');function Ms(t){const[e,o]=L(""),n=z(()=>{var g,d,b;const a=(g=t.task)==null?void 0:g.call(t);return a?ps(a,(d=t.barPosition)==null?void 0:d.call(t),((b=t.relationships)==null?void 0:b.call(t))||[]):null}),s=async()=>{const a=n();if(a!=null&&a.raw)try{await navigator.clipboard.writeText(a.raw),o("Copied!"),setTimeout(()=>o(""),2e3)}catch{o("Failed to copy"),setTimeout(()=>o(""),2e3)}},r=a=>{var g;a.target===a.currentTarget&&((g=t.onClose)==null||g.call(t))},i=a=>{var g;a.key==="Escape"&&((g=t.onClose)==null||g.call(t))};return vt(Ce,{get when(){var a;return(a=t.visible)==null?void 0:a.call(t)},get children(){var a=Ts(),g=a.firstChild,d=g.firstChild,b=d.firstChild;b.firstChild;var m=b.nextSibling,E=d.nextSibling,H=E.firstChild,v=H.firstChild,_=v.firstChild,u=_.nextSibling,c=v.nextSibling,x=H.nextSibling,w=x.firstChild,D=w.nextSibling,Y=x.nextSibling,R=Y.firstChild,l=R.nextSibling;return a.$$keydown=i,a.$$click=r,it(b,()=>{var h,X;return((X=(h=t.task)==null?void 0:h.call(t))==null?void 0:X.name)||"Unknown"},null),m.$$click=()=>{var h;return(h=t.onClose)==null?void 0:h.call(t)},u.$$click=s,it(u,()=>e()||"Copy JSON"),it(l,()=>{var h,X;return(X=(h=n())==null?void 0:h.sections)==null?void 0:X.relationships}),wt(h=>{var tt,k,p,C;var X=e()==="Copied!"?"#d4edda":"#e3f2fd",$=e()==="Copied!"?"#155724":"#1976d2",U=je(((k=(tt=n())==null?void 0:tt.sections)==null?void 0:k.rawTask)||""),K=je(((C=(p=n())==null?void 0:p.sections)==null?void 0:C.position)||"");return X!==h.e&&N(u,"background",h.e=X),$!==h.t&&N(u,"color",h.t=$),U!==h.a&&(c.innerHTML=h.a=U),K!==h.o&&(D.innerHTML=h.o=K),h},{e:void 0,t:void 0,a:void 0,o:void 0}),a}})}ae(["click","keydown"]);function _s(t){var yt;const e=po(),o=wo(t.options||{}),n=So(t.options||{}),s=Mo(t.resources||[]);typeof window<"u"&&(window.__ganttTaskStore=e,window.__ganttConfig=o,window.__ganttDateStore=n);const[r,i]=L(null),[a,g]=L(0),[d,b]=L(0),[m,E]=L(0),[H,v]=L(0),[_,u]=L(!1);let c=null;const[x,w]=L([]),[D,Y]=L([]),[R,l]=L(null),[h,X]=L({x:0,y:0}),[$,U]=L(!1),[K,tt]=L(null),[k,p]=L(!1),C=z(()=>{const y=R();return y?e.getTask(y):null}),T=z(()=>{const y=R();return y?e.getBarPosition(y):null}),F=z(()=>{const y=K();return y?e.getTask(y):null}),B=z(()=>{const y=K();return y?e.getBarPosition(y):null}),G=z(()=>{const y=K();return y?x().filter(q=>q.from===y||q.to===y):[]}),j=(y,q=!0)=>{if(!y||y.length===0){e.clear(),w([]),n.setupDates([]);return}No(y.map(St=>({_start:St._start||new Date(St.start),_end:St._end||new Date(St.end||St.start)}))),n.setupDates(y),o.setGanttStart(n.ganttStart()),o.setGanttEnd(n.ganttEnd()),o.setUnit(n.unit()),o.setStep(n.step()),o.setColumnWidth(n.columnWidth());const O={ganttStart:n.ganttStart(),ganttEnd:n.ganttEnd(),unit:n.unit(),step:n.step(),columnWidth:n.columnWidth(),headerHeight:o.headerHeight(),barHeight:o.barHeight(),padding:o.padding()};let ft=null;const xt=s.resources().length>0;if(xt&&q)ft=s.resourceIndexMap();else if(!xt){const St=To(y);s.updateResources(St),ft=s.resourceIndexMap()}const{tasks:mt,relationships:Ht,resources:Pt}=jo(y,O,ft),Rt=Zo(mt);Po(Rt);const Et=e.collapsedTasks();for(const St of Rt.values())es(St.id,Rt,Et)&&(St._isHidden=!0);e.updateTasks(Array.from(Rt.values())),w(Ht),Y(Pt)};pe(()=>{j(t.tasks)}),Dt(()=>{const y=t.tasks;s.collapsedGroups(),e.collapsedTasks(),y&&y.length>0&&Ft(()=>j(y))}),Dt(()=>{const y=t.options;y&&o.updateOptions(y)});const[V,rt]=L((yt=t.options)==null?void 0:yt.view_mode);Dt(()=>{var O;const y=(O=t.options)==null?void 0:O.view_mode,q=V();y&&y!==q&&(rt(y),n.changeViewMode(y),t.tasks&&t.tasks.length>0&&Ft(()=>j(t.tasks)))});const W=z(()=>{const y=e.tasks;return y?Object.keys(y).length:0}),J=z(()=>{const y=s.displayCount();return y>0?y:D().length}),ut=z(()=>n.gridWidth()),gt=z(()=>n.getAllDateInfos()),kt=z(()=>o.barHeight()+o.padding()),pt=z(()=>{const y=s.displayResources(),q=o.renderMode();if(!y||y.length===0)return new Map;const O=y.map((Ht,Pt)=>({id:Ht.id,type:Ht.type||"resource",displayIndex:Pt,taskId:Ht.taskId})),ft={barHeight:o.barHeight(),padding:o.padding(),subtaskHeightRatio:o.subtaskHeightRatio()};if(q==="simple")return Ko(O,ft);const xt=o.expandedTasks(),mt=e.tasks;return Oo(O,ft,xt,mt)}),Mt=z(()=>Jo(pt()));Dt(()=>{const y=pt();!y||y.size===0||Ft(()=>{for(const[q,O]of y)if(q!=="__total__"&&O.taskPositions)for(const[ft,xt]of O.taskPositions){const mt=e.tasks[ft];mt&&mt.$bar&&mt.$bar.y!==xt.y&&e.updateBarPosition(ft,{y:xt.y})}})});const f=z(()=>{const q=pt().get("__total__");return q?q.height:(J()||W())*kt()}),I=z(()=>{const y=f();if(y>0)return y;const q=o.barHeight(),O=o.padding();return(J()||W())*(q+O)}),S=Qo({scrollX:a,scrollY:d,viewportWidth:m,viewportHeight:H,columnWidth:()=>n.columnWidth(),rowHeight:kt,totalRows:()=>J()||W(),sortedRowLayouts:Mt,overscanCols:t.overscanCols??5,overscanRows:t.overscanRows??5,overscanX:t.overscanX??600}),et=(y,q)=>{var O;(O=t.onDateChange)==null||O.call(t,y,q)},st=(y,q)=>{var O;(O=t.onProgressChange)==null||O.call(t,y,q)},dt=y=>{var q;(q=t.onResizeEnd)==null||q.call(t,y)},nt=(y,q)=>{var O;tt(y),p(!0),(O=t.onTaskClick)==null||O.call(t,y,q)},at=(y,q,O)=>{l(y),X({x:q,y:O}),U(!0)},A=()=>{U(!1),l(null)},P=()=>{p(!1),tt(null)},Ct=y=>{var ft;i(y),E(y.getContainerWidth()),v(y.getContainerHeight()),y.scrollLeftSignal&&y.scrollTopSignal?Dt(()=>{const xt=y.scrollLeftSignal(),mt=y.scrollTopSignal();lo(()=>{g(xt),b(mt)})}):(y.scrollLeftSignal&&Dt(()=>g(y.scrollLeftSignal())),y.scrollTopSignal&&Dt(()=>b(y.scrollTopSignal())));let q=d(),O=a();if(Dt(()=>{const xt=a(),mt=d();(xt!==O||mt!==q)&&(O=xt,q=mt,u(!0),clearTimeout(c),c=setTimeout(()=>{u(!1)},150))}),y.containerWidthSignal&&Dt(()=>E(y.containerWidthSignal())),y.containerHeightSignal&&Dt(()=>v(y.containerHeightSignal())),((ft=t.options)==null?void 0:ft.scroll_to)==="today"){const xt=n.dateToX(new Date);y.scrollTo(xt-y.getContainerWidth()/4,!1)}};let Q=!1;Dt(()=>{var ft,xt;const y=e.tasks,q=r(),O=Object.keys(y);if(!Q&&q&&((ft=t.options)==null?void 0:ft.scroll_to)==="start"&&y&&O.length>0){const mt=y[O[0]];(xt=mt==null?void 0:mt.$bar)!=null&&xt.x&&(q.scrollTo(Math.max(0,mt.$bar.x-50),!1),Q=!0)}});const ht=()=>{var y;return((y=t.options)==null?void 0:y.upper_header_height)||45},bt=()=>{var y;return((y=t.options)==null?void 0:y.lower_header_height)||30},ct=()=>{var y;return((y=t.options)==null?void 0:y.resource_column_width)||120};return z(()=>{var y,q,O,ft;return{stroke:((y=t.options)==null?void 0:y.arrow_color)||"#666",curveRadius:((q=t.options)==null?void 0:q.arrow_curve)||5,headShape:((O=t.options)==null?void 0:O.arrow_head_shape)||"chevron",headSize:((ft=t.options)==null?void 0:ft.arrow_head_size)||5,...t.arrowConfig}}),vt(io,{onDateChange:et,onProgressChange:st,onResizeEnd:dt,onTaskClick:nt,onHover:at,onHoverEnd:A,get children(){return[vt(go,{ganttConfig:o,get svgWidth(){return ut()},get svgHeight(){return I()},get headerHeight(){return o.headerHeight()},get resourceColumnWidth(){return ct()},resourceHeaderLabel:"Resource",onContainerReady:Ct,get resourceColumn(){return vt(ao,{resourceStore:s,ganttConfig:o,get width(){return ct()},get startRow(){return S.rowRange().start},get endRow(){return S.rowRange().end},get rowLayouts(){return pt()}})},get header(){return vt(ro,{get dateInfos(){return gt()},get columnWidth(){return n.columnWidth()},get gridWidth(){return ut()},get upperHeaderHeight(){return ht()},get lowerHeaderHeight(){return bt()},get startCol(){return S.colRange().start},get endCol(){return S.colRange().end}})},get barsLayer(){return we(()=>t.taskLayerMode==="minimal")()?vt(ys,{taskStore:e,ganttConfig:o,resourceStore:s,get startRow(){return S.rowRange().start},get endRow(){return S.rowRange().end},get startX(){return S.xRange().start},get endX(){return S.xRange().end}}):vt(hs,{taskStore:e,ganttConfig:o,get relationships(){return x()},resourceStore:s,onDateChange:et,onProgressChange:st,onResizeEnd:dt,onTaskClick:nt,onHover:at,onHoverEnd:A,get startRow(){return S.rowRange().start},get endRow(){return S.rowRange().end},get startX(){return S.xRange().start},get endX(){return S.xRange().end},get rowLayouts(){return pt()}})},get children(){return vt(so,{get width(){return ut()},get height(){return I()},get barHeight(){return o.barHeight()},get padding(){return o.padding()},get taskCount(){return J()||W()},get columnWidth(){return n.columnWidth()},get dateInfos(){return gt()},get lines(){var y;return((y=t.options)==null?void 0:y.lines)||"both"},get startRow(){return S.rowRange().start},get endRow(){return S.rowRange().end},resourceStore:s,get rowLayouts(){return pt()}})}}),vt(Cs,{visible:$,position:h,task:C,barPosition:T}),vt(Ms,{visible:k,task:F,barPosition:B,relationships:G,onClose:P})]}})}function $s(){var _;let t=[],e=!1,o=null,n=null,s=0,r=!1;const i=typeof PerformanceObserver<"u"&&((_=PerformanceObserver.supportedEntryTypes)==null?void 0:_.includes("long-animation-frame"));function a(){o=new PerformanceObserver(u=>{var c;for(const x of u.getEntries())t.push({timestamp:x.startTime,duration:x.duration,blockingDuration:x.blockingDuration||0,scripts:((c=x.scripts)==null?void 0:c.map(w=>w.sourceURL||w.name))||[],source:"laf",renderStart:x.renderStart,styleAndLayoutStart:x.styleAndLayoutStart,firstUIEventTimestamp:x.firstUIEventTimestamp})}),o.observe({type:"long-animation-frame",buffered:!0}),r=!0}function g(){s=performance.now();function u(){if(!e)return;const c=performance.now(),x=c-s;x>4&&t.push({timestamp:s,duration:x,blockingDuration:x>16.67?x-16.67:0,scripts:[],source:"raf"}),s=c,n=requestAnimationFrame(u)}n=requestAnimationFrame(u),r=!1}function d(u={}){e||(t=[],e=!0,i&&!u.preferRAF?a():g())}function b(){e=!1,o&&(o.disconnect(),o=null),n&&(cancelAnimationFrame(n),n=null)}function m(){return[...t]}function E(){t=[]}function H(){if(t.length===0)return{frameCount:0,totalDuration:0,avgFrameTime:0,avgFPS:0,minFrameTime:0,maxFrameTime:0,worstFrame:null,droppedFrames:0,percentile95:0,percentile99:0,blockingTime:0,source:r?"laf":"raf"};const u=t.map(l=>l.duration).sort((l,h)=>l-h),c=u.reduce((l,h)=>l+h,0),x=t.reduce((l,h)=>l+h.blockingDuration,0),w=t.reduce((l,h)=>h.duration>l.duration?h:l,t[0]),D=t.filter(l=>l.duration>16.67).length,Y=Math.floor(u.length*.95),R=Math.floor(u.length*.99);return{frameCount:t.length,totalDuration:c,avgFrameTime:c/t.length,avgFPS:1e3/(c/t.length),minFrameTime:u[0],maxFrameTime:u[u.length-1],worstFrame:{timestamp:w.timestamp,duration:w.duration,blockingDuration:w.blockingDuration,scripts:w.scripts},droppedFrames:D,droppedFramePercent:D/t.length*100,percentile95:u[Y]||u[u.length-1],percentile99:u[R]||u[u.length-1],blockingTime:x,source:r?"laf":"raf"}}function v(u=100){if(t.length===0)return[];const c=[];let x=t[0].timestamp,w=[];for(const D of t){if(D.timestamp-x>=u){if(w.length>0){const R=w.reduce((l,h)=>l+h.duration,0)/w.length;c.push({time:x,fps:1e3/R,frameCount:w.length})}x=D.timestamp,w=[]}w.push(D)}if(w.length>0){const Y=w.reduce((R,l)=>R+l.duration,0)/w.length;c.push({time:x,fps:1e3/Y,frameCount:w.length})}return c}return{startTracking:d,stopTracking:b,getFrames:m,clear:E,analyze:H,getFPSTimeline:v,get isTracking(){return e},get hasLAF(){return i}}}const nn=new Map;let Me=[],Se=!1;function Ds(){Se=!0,Me=[];function t(){Se&&(performance.now(),requestAnimationFrame(t))}requestAnimationFrame(t)}function Hs(){Se=!1}function Rs(){nn.clear(),Me=[]}function Fs(){return Array.from(nn.values()).map(t=>({...t,minTime:t.minTime===1/0?0:t.minTime}))}function Ps(){const t=new Map;for(const o of Me)t.has(o.frameId)||t.set(o.frameId,[]),t.get(o.frameId).push(o);const e=[];for(const[o,n]of t)if(n.length>1){const s=new Set(n.map(i=>i.name)),r=n.reduce((i,a)=>i+a.duration,0);e.push({frameId:o,memoCount:s.size,invocationCount:n.length,totalTime:r,memos:Array.from(s),invocations:n.sort((i,a)=>i.timestamp-a.timestamp)})}return e.sort((o,n)=>n.totalTime-o.totalTime)}function Es(){const t=Fs(),e=Ps(),o=[],n=.1,s=1,r=100,i=5;for(const a of t){const g={name:a.name,status:"KEEP_MEMO",reason:"",metrics:{callCount:a.callCount,avgTime:a.avgTime.toFixed(3),totalTime:a.totalTime.toFixed(3)}};if(a.avgTime<n&&a.callCount<r)g.status="CONSIDER_PLAIN_FUNCTION",g.reason=`Avg time ${a.avgTime.toFixed(3)}ms is under ${n}ms threshold. Memo overhead may exceed computation cost.`;else if(a.avgTime>s&&a.callCount>r)g.status="OPTIMIZE_COMPUTATION",g.reason=`Called ${a.callCount} times with avg ${a.avgTime.toFixed(3)}ms. Total ${a.totalTime.toFixed(1)}ms spent in this memo.`;else{const d=e.filter(b=>b.memos.includes(a.name)).length;d>i&&(g.status="CHECK_REACTIVE_CASCADE",g.reason=`Involved in ${d} cascade events. May be triggering unnecessary reactive updates.`)}o.push(g)}return o.sort((a,g)=>{const d=parseFloat(a.metrics.totalTime);return parseFloat(g.metrics.totalTime)-d}),{summary:{memoCount:t.length,totalInvocations:t.reduce((a,g)=>a+g.callCount,0),totalTime:t.reduce((a,g)=>a+g.totalTime,0),cascadeEvents:e.length},recommendations:o,cascades:e.slice(0,10)}}function Is(t){const{frameAnalysis:e={},memoAnalysis:o={},config:n={},timeline:s=[]}=t;return{metadata:{version:"1.0.0",timestamp:new Date().toISOString(),browser:Ws(),userAgent:(navigator==null?void 0:navigator.userAgent)||"unknown"},configuration:{taskCount:n.taskCount??0,arrowCount:n.arrowCount??0,viewMode:n.viewMode??"Day",viewportWidth:n.viewportWidth??(window==null?void 0:window.innerWidth)??0,viewportHeight:n.viewportHeight??(window==null?void 0:window.innerHeight)??0,arrowRenderer:n.arrowRenderer??"individual",testDuration:n.testDuration??0,testType:n.testType??"manual"},frameMetrics:{frameCount:e.frameCount??0,totalDuration:Tt(e.totalDuration),avgFrameTime:Tt(e.avgFrameTime),avgFPS:Tt(e.avgFPS),minFrameTime:Tt(e.minFrameTime),maxFrameTime:Tt(e.maxFrameTime),percentile95:Tt(e.percentile95),percentile99:Tt(e.percentile99),droppedFrames:e.droppedFrames??0,droppedFramePercent:Tt(e.droppedFramePercent),blockingTime:Tt(e.blockingTime),source:e.source??"unknown",worstFrame:e.worstFrame?{timestamp:Tt(e.worstFrame.timestamp),duration:Tt(e.worstFrame.duration),blockingDuration:Tt(e.worstFrame.blockingDuration),scripts:e.worstFrame.scripts||[]}:null},memoAnalysis:{summary:o.summary??{},recommendations:(o.recommendations||[]).slice(0,20),cascades:(o.cascades||[]).slice(0,10)},memory:zs(),timeline:s.map(r=>({time:Tt(r.time),fps:Tt(r.fps),frameCount:r.frameCount}))}}function As(t,e={}){const{pretty:o=!0}=e;return JSON.stringify(t,null,o?2:0)}function Ls(t,e){const o=As(t),n=new Blob([o],{type:"application/json"}),s=URL.createObjectURL(n),r=new Date().toISOString().replace(/[:.]/g,"-"),i=e||`gantt-benchmark-${r}.json`,a=document.createElement("a");a.href=s,a.download=i,a.click(),URL.revokeObjectURL(s)}function Bs(t){var o,n,s,r;const e=[];if(e.push("=== Gantt Chart Performance Benchmark ==="),e.push(`Timestamp: ${t.metadata.timestamp}`),e.push(`Browser: ${t.metadata.browser}`),e.push(""),e.push("Configuration:"),e.push(`  Tasks: ${t.configuration.taskCount}`),e.push(`  Arrows: ${t.configuration.arrowCount}`),e.push(`  Arrow Renderer: ${t.configuration.arrowRenderer}`),e.push(`  Viewport: ${t.configuration.viewportWidth}x${t.configuration.viewportHeight}`),e.push(""),e.push("Frame Metrics:"),e.push(`  Average FPS: ${t.frameMetrics.avgFPS}`),e.push(`  Average Frame: ${t.frameMetrics.avgFrameTime}ms`),e.push(`  Worst Frame: ${t.frameMetrics.maxFrameTime}ms`),e.push(`  95th Percentile: ${t.frameMetrics.percentile95}ms`),e.push(`  Dropped Frames: ${t.frameMetrics.droppedFrames} (${t.frameMetrics.droppedFramePercent}%)`),e.push(`  Measurement Source: ${t.frameMetrics.source}`),e.push(""),(n=(o=t.memoAnalysis)==null?void 0:o.summary)!=null&&n.memoCount&&(e.push("Memo Analysis:"),e.push(`  Tracked Memos: ${t.memoAnalysis.summary.memoCount}`),e.push(`  Total Invocations: ${t.memoAnalysis.summary.totalInvocations}`),e.push(`  Total Time: ${Tt(t.memoAnalysis.summary.totalTime)}ms`),e.push(`  Cascade Events: ${t.memoAnalysis.summary.cascadeEvents}`),((s=t.memoAnalysis.recommendations)==null?void 0:s.length)>0)){e.push(""),e.push("Top Recommendations:");for(const i of t.memoAnalysis.recommendations.slice(0,5))e.push(`  [${i.status}] ${i.name}`),i.reason&&e.push(`    ${i.reason}`)}return(r=t.memory)!=null&&r.jsHeapSizeLimit&&(e.push(""),e.push("Memory:"),e.push(`  Used Heap: ${Ne(t.memory.usedJSHeapSize)}`),e.push(`  Total Heap: ${Ne(t.memory.totalJSHeapSize)}`)),e.join(`
`)}function Tt(t,e=2){return typeof t!="number"||isNaN(t)?0:Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function Ws(){if(typeof navigator>"u")return"unknown";const t=navigator.userAgent;if(t.includes("Chrome")){const e=t.match(/Chrome\/(\d+)/);return`Chrome ${(e==null?void 0:e[1])||""}`}if(t.includes("Firefox")){const e=t.match(/Firefox\/(\d+)/);return`Firefox ${(e==null?void 0:e[1])||""}`}if(t.includes("Safari")&&!t.includes("Chrome")){const e=t.match(/Version\/(\d+)/);return`Safari ${(e==null?void 0:e[1])||""}`}return"unknown"}function zs(){return typeof performance>"u"||!performance.memory?null:{jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize}}function Ne(t){if(t===0)return"0 B";const e=1024,o=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,n)).toFixed(2))+" "+o[n]}var Ys=$t('<div><div><h1 style=margin:0;font-size:20px>Performance Test</h1><div><div><span>Tasks:</span><span></span></div><div><span>Arrows:</span><span></span></div><div><span>Render:</span><span></span></div><div><span>FPS:</span><span></span></div><div><span>Worst:</span><span>ms</span></div><div><span>Avg:</span><span>ms</span></div><div><span>Scroll/s:</span><span></span></div><div><span>Heap:</span><span></span></div></div><div><label style=font-size:13px>View:<select style=width:100px;margin-left:5px><option value=Hour>Hour</option><option value=Day>Day</option><option value=Week>Week</option><option value=Month>Month</option></select></label><button>Reload</button><button></button><button></button><span style="color:#9ca3af;margin:0 5px">|</span><button></button><button>Export JSON</button><label style=font-size:13px>Arrows:<select style=width:100px;margin-left:5px><option value=individual>Individual</option><option value=batched>Batched</option></select></label><label style=font-size:13px>Mode:<select style=width:100px;margin-left:5px><option value=simple>Simple</option><option value=detailed>Detailed</option></select></label><label style=font-size:13px>TaskLayer:<select style=width:100px;margin-left:5px><option value=full>Full</option><option value=minimal>Minimal (V7j)</option></select></label></div><div style=display:flex;gap:15px;align-items:center;font-size:12px;color:#6b7280><span style=font-weight:bold>Buffers:</span><label style=display:flex;align-items:center;gap:4px>Rows:<input type=range min=1 max=30 style=width:60px><span style=min-width:20px></span></label><label style=display:flex;align-items:center;gap:4px>X:<input type=range min=200 max=3000 step=100 style=width:60px><span style=min-width:45px>px</span></label><label style=display:flex;align-items:center;gap:4px>Cols:<input type=range min=1 max=30 style=width:60px><span style=min-width:20px></span></label></div></div><div>');function Xs(){const[t,e]=L([]),[o,n]=L(null),[s,r]=L({tasks:0,arrows:0}),[i,a]=L("Hour"),[g,d]=L(0),[b,m]=L(0),[E,H]=L(0),[v,_]=L(!1),[u,c]=L(!1),[x,w]=L(0),[D,Y]=L(5),[R,l]=L(600),[h,X]=L(5),[$,U]=L(null),[K,tt]=L(!1),[k,p]=L(null),[C,T]=L("batched"),[F,B]=L("simple"),[G,j]=L("full");let V=null,rt=performance.now(),W=[],J=0,ut=performance.now(),gt=0,kt=performance.now();const[,pt]=fo(Q=>{gt++;const ht=Q-rt;rt=Q,W.push(ht),W.length>60&&W.shift();const bt=Q-kt;if(bt>=1e3){if(d(Math.round(gt*1e3/bt)),gt=0,kt=Q,W.length>0){const yt=Math.max(...W),y=W.reduce((q,O)=>q+O,0)/W.length;m(yt.toFixed(1)),H(y.toFixed(1))}const ct=Q-ut;ct>=1e3&&(w(Math.round(J*1e3/ct)),J=0,ut=Q),performance.memory&&U((performance.memory.usedJSHeapSize/1048576).toFixed(1))}});let Mt=null;const f=()=>{if(v()){Mt&&(Mt.abort=!0),_(!1);return}const Q=document.querySelector(".gantt-scroll-area");if(!Q)return;_(!0),W=[],m(0);const ht={abort:!1};Mt=ht;const bt=3e4,ct=performance.now();let yt=1,y=Q.scrollLeft;const q=()=>{if(ht.abort||performance.now()-ct>bt){_(!1),console.log("H-Scroll test complete:",{worst:b(),avg:E()});return}const O=yt*200;y+=O,y>Q.scrollWidth-Q.clientWidth-500?yt=-1:y<500&&(yt=1),Q.scrollLeft=y,requestAnimationFrame(q)};requestAnimationFrame(q)};let I=null;const S=()=>{if(u()){I&&(I.abort=!0),c(!1);return}const Q=document.querySelector(".gantt-scroll-area");if(!Q)return;c(!0),W=[],m(0);const ht={abort:!1};I=ht;const bt=3e4,ct=performance.now();let yt=1,y=Q.scrollTop;const q=()=>{if(ht.abort||performance.now()-ct>bt){c(!1),console.log("V-Scroll test complete:",{worst:b(),avg:E()});return}const O=yt*100;y+=O,y>Q.scrollHeight-Q.clientHeight-200?yt=-1:y<200&&(yt=1),Q.scrollTop=y,requestAnimationFrame(q)};requestAnimationFrame(q)},et=()=>{if(K()){st();return}V=$s(),Rs(),Ds(),V.startTracking(),tt(!0),W=[],console.log("Benchmark started - scroll or interact, then click Stop")},st=()=>{if(!K())return;V==null||V.stopTracking(),Hs(),tt(!1);const Q=(V==null?void 0:V.analyze())||{},ht=Es(),bt=(V==null?void 0:V.getFPSTimeline(100))||[],ct=Is({frameAnalysis:Q,memoAnalysis:ht,timeline:bt,config:{taskCount:s().tasks,arrowCount:s().arrows,viewMode:i(),arrowRenderer:C(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,testType:"manual"}});p(ct),console.log("Benchmark complete:",Bs(ct))},dt=()=>{const Q=k();Q?Ls(Q):console.warn("No benchmark results to export. Run a benchmark first.")};pe(()=>{const Q=document.querySelector(".gantt-scroll-area");if(Q){const ct=()=>J++;Q.addEventListener("scroll",ct,{passive:!0}),xe(()=>Q.removeEventListener("scroll",ct))}let ht=0;const bt=setInterval(()=>{if(v()||u()){const ct=performance.now();ct-ht>2e3&&(ht=ct,console.log("[PERF]",{fps:g(),avgFrame:E()+"ms",worstFrame:b()+"ms",scrollEvents:x()+"/sec",heap:$()+"MB"}))}},500);xe(()=>clearInterval(bt))});const nt=z(()=>({view_mode:i(),renderMode:F(),bar_height:20,padding:8,column_width:i()==="Hour"?25:30,upper_header_height:35,lower_header_height:25,headerHeight:60,lines:"both",scroll_to:"start"})),at=()=>{const Q=performance.now();e(co.tasks),requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(()=>{n((performance.now()-Q).toFixed(1)),r({tasks:document.querySelectorAll(".bar-wrapper").length,arrows:document.querySelectorAll(".arrow-layer > g").length})},0)})})};pe(()=>{at(),pt()});const A={container:{"max-width":"100%",height:"100vh",margin:0,padding:"10px",display:"flex","flex-direction":"column","box-sizing":"border-box",overflow:"hidden","font-family":'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},header:{"margin-bottom":"10px",display:"flex","align-items":"center",gap:"20px","flex-wrap":"wrap"},stats:{display:"flex",gap:"15px",padding:"10px 15px","background-color":"#1f2937",color:"#fff","border-radius":"6px","font-size":"13px","font-family":"monospace"},statItem:{display:"flex",gap:"5px"},statLabel:{color:"#9ca3af"},statValue:{color:"#10b981","font-weight":"bold"},controls:{display:"flex",gap:"10px","align-items":"center"},select:{padding:"6px 10px",border:"1px solid #d1d5db","border-radius":"4px","font-size":"13px",cursor:"pointer"},button:{padding:"6px 12px","background-color":"#3b82f6",color:"#fff",border:"none","border-radius":"4px",cursor:"pointer","font-size":"13px"},ganttWrapper:{border:"1px solid #e0e0e0","border-radius":"8px",overflow:"hidden","background-color":"#fff",flex:1,"min-height":0}},P=()=>g()>=55?"#10b981":g()>=30?"#f59e0b":"#ef4444",Ct=Q=>Q<=16.67?"#10b981":Q<=33?"#f59e0b":"#ef4444";return(()=>{var Q=Ys(),ht=Q.firstChild,bt=ht.firstChild,ct=bt.nextSibling,yt=ct.firstChild,y=yt.firstChild,q=y.nextSibling,O=yt.nextSibling,ft=O.firstChild,xt=ft.nextSibling,mt=O.nextSibling,Ht=mt.firstChild,Pt=Ht.nextSibling,Rt=mt.nextSibling,Et=Rt.firstChild,St=Et.nextSibling,It=Rt.nextSibling,qt=It.firstChild,At=qt.nextSibling,Kt=At.firstChild,Lt=It.nextSibling,Vt=Lt.firstChild,Bt=Vt.nextSibling,Qt=Bt.firstChild,Wt=Lt.nextSibling,jt=Wt.firstChild,Nt=jt.nextSibling,Ut=Wt.nextSibling,Ot=Ut.firstChild,_e=Ot.nextSibling,ie=ct.nextSibling,$e=ie.firstChild,on=$e.firstChild,le=on.nextSibling,ce=$e.nextSibling,Zt=ce.nextSibling,te=Zt.nextSibling,sn=te.nextSibling,ee=sn.nextSibling,ne=ee.nextSibling,De=ne.nextSibling,rn=De.firstChild,de=rn.nextSibling,He=De.nextSibling,an=He.firstChild,ue=an.nextSibling,ln=He.nextSibling,cn=ln.firstChild,ge=cn.nextSibling,dn=ie.nextSibling,un=dn.firstChild,Re=un.nextSibling,gn=Re.firstChild,fe=gn.nextSibling,fn=fe.nextSibling,Fe=Re.nextSibling,hn=Fe.firstChild,he=hn.nextSibling,Pe=he.nextSibling,mn=Pe.firstChild,vn=Fe.nextSibling,xn=vn.firstChild,me=xn.nextSibling,yn=me.nextSibling,Ee=ht.nextSibling;return it(q,()=>s().tasks),it(xt,()=>s().arrows),it(Pt,(()=>{var M=we(()=>!!o());return()=>M()?`${o()}ms`:"..."})()),it(St,g),it(At,b,Kt),it(Bt,E,Qt),it(Nt,x),it(_e,(()=>{var M=we(()=>!!$());return()=>M()?`${$()}MB`:"N/A"})()),le.addEventListener("change",M=>a(M.target.value)),ce.$$click=at,Zt.$$click=f,it(Zt,()=>v()?"Stop":"H-Scroll"),te.$$click=S,it(te,()=>u()?"Stop":"V-Scroll"),ee.$$click=et,it(ee,()=>K()?"Stop Bench":"Benchmark"),ne.$$click=dt,de.addEventListener("change",M=>T(M.target.value)),ue.addEventListener("change",M=>B(M.target.value)),ge.addEventListener("change",M=>j(M.target.value)),fe.$$input=M=>Y(+M.target.value),it(fn,D),he.$$input=M=>l(+M.target.value),it(Pe,R,mn),me.$$input=M=>X(+M.target.value),it(yn,h),it(Ee,vt(_s,{get tasks(){return t()},get options(){return nt()},get overscanRows(){return D()},get overscanX(){return R()},get overscanCols(){return h()},get arrowRenderer(){return C()},get taskLayerMode(){return G()},onDateChange:(M,Gt)=>console.log("Date changed:",M,Gt),onProgressChange:(M,Gt)=>console.log("Progress changed:",M,Gt),onTaskClick:M=>console.log("Task clicked:",M)})),wt(M=>{var Gt=A.container,bn=A.header,pn=A.stats,wn=A.statItem,kn=A.statLabel,Sn=A.statValue,Cn=A.statItem,Tn=A.statLabel,Mn=A.statValue,_n=A.statItem,$n=A.statLabel,Dn=A.statValue,Hn=A.statItem,Rn=A.statLabel,Fn={...A.statValue,color:P()},Pn=A.statItem,En=A.statLabel,In={...A.statValue,color:Ct(b())},An=A.statItem,Ln=A.statLabel,Bn={...A.statValue,color:Ct(E())},Wn=A.statItem,zn=A.statLabel,Yn=A.statValue,Xn=A.statItem,qn=A.statLabel,Vn=A.statValue,jn=A.controls,Nn={...A.select},Un=A.button,On={...A.button,"background-color":v()?"#ef4444":"#8b5cf6"},Gn={...A.button,"background-color":u()?"#ef4444":"#8b5cf6"},Jn={...A.button,"background-color":K()?"#ef4444":"#059669"},Kn={...A.button,"background-color":k()?"#0891b2":"#6b7280"},Ie=!k(),Qn={...A.select},Zn={...A.select},to={...A.select},eo=A.ganttWrapper;return M.e=ot(Q,Gt,M.e),M.t=ot(ht,bn,M.t),M.a=ot(ct,pn,M.a),M.o=ot(yt,wn,M.o),M.i=ot(y,kn,M.i),M.n=ot(q,Sn,M.n),M.s=ot(O,Cn,M.s),M.h=ot(ft,Tn,M.h),M.r=ot(xt,Mn,M.r),M.d=ot(mt,_n,M.d),M.l=ot(Ht,$n,M.l),M.u=ot(Pt,Dn,M.u),M.c=ot(Rt,Hn,M.c),M.w=ot(Et,Rn,M.w),M.m=ot(St,Fn,M.m),M.f=ot(It,Pn,M.f),M.y=ot(qt,En,M.y),M.g=ot(At,In,M.g),M.p=ot(Lt,An,M.p),M.b=ot(Vt,Ln,M.b),M.T=ot(Bt,Bn,M.T),M.A=ot(Wt,Wn,M.A),M.O=ot(jt,zn,M.O),M.I=ot(Nt,Yn,M.I),M.S=ot(Ut,Xn,M.S),M.W=ot(Ot,qn,M.W),M.C=ot(_e,Vn,M.C),M.B=ot(ie,jn,M.B),M.v=ot(le,Nn,M.v),M.k=ot(ce,Un,M.k),M.x=ot(Zt,On,M.x),M.j=ot(te,Gn,M.j),M.q=ot(ee,Jn,M.q),M.z=ot(ne,Kn,M.z),Ie!==M.P&&(ne.disabled=M.P=Ie),M.H=ot(de,Qn,M.H),M.F=ot(ue,Zn,M.F),M.M=ot(ge,to,M.M),M.D=ot(Ee,eo,M.D),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0,H:void 0,F:void 0,M:void 0,D:void 0}),wt(()=>le.value=i()),wt(()=>de.value=C()),wt(()=>ue.value=F()),wt(()=>ge.value=G()),wt(()=>fe.value=D()),wt(()=>he.value=R()),wt(()=>me.value=h()),Q})()}ae(["click","input"]);uo(()=>vt(Xs,{}),document.getElementById("app"));
